/* =========================
   RIP-KIM chat.js (full)
   - FaceDetector ÏÇ¨Ïö©, ÎØ∏ÏßÄÏõê Ïãú face-api.js ÏûêÎèô Î°úÎìú Ìè¥Î∞±
   - Safari ÎåÄÏùë(loadedmetadata ÎåÄÍ∏∞), 150ms Í∞ÑÍ≤© Ï∂îÏ†Å
   - Ïπ¥Î©îÎùº ÌîÑÎ¶¨Î∑∞ Ìå®ÎÑê + ÏÉÅÌÉú ÌëúÏãú
   - ASCII Ï¥àÏÉÅ Î∞©Ìñ•/ÍπúÎπ°ÏûÑ/ÏûÖ Î™®Ïñë Ïó∞Îèô
   ========================= */

// === DOM ===
const chatBox   = document.getElementById('chat-box');
const userInput = document.getElementById('user-input');
const sendButton= document.getElementById('send-button');

// ‚ñ≤ Ï¥àÏÉÅ ASCII Ï∂úÎ†• ÏóòÎ¶¨Î®ºÌä∏
const portraitEl = document.getElementById('portrait');

// === ÏÉÅÌÉú ===
let conversationHistory = []; // [{role:'user'|'assistant', content:string}]
let isSpeechEnabled = true;
let userName = '';
let isUserNameSet = false;

// === Hangul Î™®Ïùå ÌåêÎ≥Ñ Ïú†Ìã∏ (Ï†ÑÏó≠) ===
const HANGUL_BASE = 0xAC00;
const HANGUL_LAST = 0xD7A3;
// Ï§ëÏÑ± Ïù∏Îç±Ïä§ 0..20: „Öè,„Öê,„Öë,„Öí,„Öì,„Öî,„Öï,„Öñ,„Öó,„Öò,„Öô,„Öö,„Öõ,„Öú,„Öù,„Öû,„Öü,„Ö†,„Ö°,„Ö¢,„Ö£
const OPEN_JUNGSEONG = new Set([8,9,10,11,12,13,14,15,16,17,18,20]); 
function isLatinVowel(ch){ return /[AEIOUaeiou]/.test(ch); }
function isHangulOpenVowel(ch){
  const code = ch.codePointAt(0);
  if (code < HANGUL_BASE || code > HANGUL_LAST) return false;
  const syllableIndex = code - HANGUL_BASE;
  const jung = Math.floor(syllableIndex / 28) % 21;
  return OPEN_JUNGSEONG.has(jung);
}
function isVowelChar(ch){
  if(!/\S/.test(ch)) return false;
  return isLatinVowel(ch) || isHangulOpenVowel(ch);
}

// === Ïò§ÎîîÏò§ (Îã®Ïùº AudioContext Ïû¨ÏÇ¨Ïö©) ===
let audioCtx;
function ensureAudioCtx(){
  if (!audioCtx){
    const C = window.AudioContext || window.webkitAudioContext;
    audioCtx = new C();
  }
  return audioCtx;
}
function playBeep(freq = 440){
  if (!isSpeechEnabled) return;
  try{
    const ctx = ensureAudioCtx();
    const osc = ctx.createOscillator();
    const gain= ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.frequency.setValueAtTime(freq, ctx.currentTime);
    gain.gain.setValueAtTime(0.0001, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
    gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.1);
    osc.start(); osc.stop(ctx.currentTime + 0.12);
  }catch{}
}

// === ÏïàÏ†ÑÌïú ÌÉÄÏù¥Ìïë Ìö®Í≥º (ÎπÑÌîÑ ÎèôÍ∏∞ ÏΩúÎ∞± ÏßÄÏõê) ===
function typeWriter(element, text, delay = 16, onChar = null, onDone = null){
  element.textContent = '';
  let i = 0;
  (function tick(){
    if (i < text.length){
      const ch = text.charAt(i);
      element.textContent += ch;
      playBeep(220 + (ch.charCodeAt(0) % 220));
      if (typeof onChar === 'function') onChar(ch);
      i++;
      setTimeout(tick, delay);
    } else {
      if (typeof onDone === 'function') onDone();
    }
  })();
}
function splitAndTypeWriter(element, text, maxLength = 160, delay = 16, onChar = null, onAllDone = null){
  const words = text.split(' ');
  const parts = [];
  let part = '';
  for (const w of words){
    if ((part + (part ? ' ' : '') + w).length > maxLength){
      parts.push(part); part = w;
    } else {
      part += (part ? ' ' : '') + w;
    }
  }
  if (part) parts.push(part);

  (async () => {
    for (let idx = 0; idx < parts.length; idx++){
      const p = parts[idx];
      const line = document.createElement('div');
      element.appendChild(line);
      await new Promise(resolve => {
        typeWriter(line, p, delay, onChar, () => setTimeout(resolve, 20));
      });
    }
    if (typeof onAllDone === 'function') onAllDone();
  })();
}

// === ÌûàÏä§ÌÜ†Î¶¨ ===
function pushHistory(role, content){
  conversationHistory.push({ role, content });
  const MAX = 20;
  if (conversationHistory.length > MAX){
    conversationHistory = conversationHistory.slice(-MAX);
  }
}

/* =========================
   üìº ÌîÑÎ†àÏûÑÎì§ (ÎÑ§Í∞Ä Ï§Ä ASCII ÏõêÎ¨∏)
   ========================= */

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (Ï†ïÎ©¥)
const F_OC_CENTER = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñë‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (Ïò§Î•∏Ï™Ω)
const F_OC_RIGHT = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñí‚ñí     ‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (ÏôºÏ™Ω)
const F_OC_LEFT = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (Ï†ïÎ©¥)
const F_OO_CENTER = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë                                 
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñë‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí      ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (Ïò§Î•∏Ï™Ω)
const F_OO_RIGHT = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë                                 
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñí‚ñí     ‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí      ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (ÏôºÏ™Ω) ‚Äî Ï†úÍ≥µ ÌååÏùºÏóî Î≥ÄÌòï Î≤ÑÏ†ÑÏù¥ ÏûàÏóàÏßÄÎßå Î∞©Ìñ• ÏùºÍ¥ÄÏÑ±ÏùÑ ÏúÑÌï¥ Ï†ïÎ©¥ÏúºÎ°ú ÎåÄÏ≤¥
const F_OO_LEFT = F_OO_CENTER;

// Îàà Í∞êÍ≥† ÏûÖ Îã´Ïùå (Ï†ïÎ©¥)
const F_CC_CENTER = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí    ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

// Îàà Í∞êÍ≥† ÏûÖ Î≤åÎ¶º (Ï†ïÎ©¥)
const F_CO_CENTER = String.raw`                            
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí    ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë   
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`;

/* =========================
   ÌîÑÎ†àÏûÑ Ï†ïÍ∑úÌôî & ÏÑ†ÌÉù
   ========================= */

function splitLines(s){ return s.replace(/\r\n/g, '\n').split('\n'); }
function joinLines(arr){ return arr.join('\n'); }
function getMaxColsRows(frames){
  let maxCols = 0, maxRows = 0;
  for (const f of frames){
    const lines = splitLines(f);
    maxRows = Math.max(maxRows, lines.length);
    for (const ln of lines) maxCols = Math.max(maxCols, ln.length);
  }
  return { maxCols, maxRows };
}
function normalizeFrames(frames){
  const { maxCols, maxRows } = getMaxColsRows(frames);
  const normalized = frames.map(f=>{
    const lines = splitLines(f);
    const out = [];
    for (let r=0;r<maxRows;r++){
      const src = lines[r] ?? '';
      const pad = src + ' '.repeat(Math.max(0, maxCols - src.length));
      out.push(pad);
    }
    return joinLines(out);
  });
  return { normalized, maxRows };
}

// Ï†ïÍ∑úÌôî Ïã§Ìñâ (Î™®Îì† ÌîÑÎ†àÏûÑ Îì±Î°ù)
const FRAME_LIST = [
  F_OC_CENTER, F_OC_LEFT, F_OC_RIGHT,
  F_OO_CENTER, F_OO_LEFT, F_OO_RIGHT,
  F_CC_CENTER, F_CO_CENTER
];
const { normalized: __NF__, maxRows: __MAX_ROWS__ } = normalizeFrames(FRAME_LIST);

// Ï†ïÍ∑úÌôîÎêú ÌîÑÎ†àÏûÑÏóê Ïû¨Îß§Ìïë(ÏàúÏÑú Ï£ºÏùò)
const NF_OC_CENTER = __NF__[0];
const NF_OC_LEFT   = __NF__[1];
const NF_OC_RIGHT  = __NF__[2];
const NF_OO_CENTER = __NF__[3];
const NF_OO_LEFT   = __NF__[4];
const NF_OO_RIGHT  = __NF__[5];
const NF_CC_CENTER = __NF__[6];
const NF_CO_CENTER = __NF__[7];

// ÏÑ†ÌÉùÏö© ÌÖåÏù¥Î∏î
const FRAMES_OPEN_EYES = {
  mouthClosed: { left: NF_OC_LEFT, center: NF_OC_CENTER, right: NF_OC_RIGHT },
  mouthOpen:   { left: NF_OO_LEFT, center: NF_OO_CENTER, right: NF_OO_RIGHT },
};
const FRAMES_CLOSED_EYES = {
  mouthClosed: NF_CC_CENTER,  // Îàà Í∞êÏùå + ÏûÖ Îã´Ïùå
  mouthOpen:   NF_CO_CENTER,  // Îàà Í∞êÏùå + ÏûÖ Î≤åÎ¶º
};

function lockPortraitHeight(){
  if (!portraitEl) return;
  const cs = getComputedStyle(portraitEl);
  let lh = parseFloat(cs.lineHeight);
  if (Number.isNaN(lh)) lh = parseFloat(cs.fontSize) * 1.2;
  portraitEl.style.minHeight = `${Math.ceil(lh * __MAX_ROWS__)}px`;
}

/* =========================
   üìπ Ïπ¥Î©îÎùº ÌîÑÎ¶¨Î∑∞ ÏÑ§Ï†ï/Ìå®ÎÑê
   ========================= */

let CAMERA_PREVIEW_ENABLED = true;
window.setCameraPreviewEnabled = function(flag){
  CAMERA_PREVIEW_ENABLED = !!flag;
  const panel = document.getElementById('cam-preview');
  if (panel) panel.style.display = CAMERA_PREVIEW_ENABLED ? 'block' : 'none';
};

let camPanel = null, camVideo = null, camStatus = null;
function createCameraPreview(){
  if (document.getElementById('cam-preview')) return;

  camPanel = document.createElement('div');
  camPanel.id = 'cam-preview';
  Object.assign(camPanel.style, {
    position: 'fixed', left: '12px', top: '12px', width: '220px',
    background: 'rgba(0,0,0,0.6)', color: '#ddd', fontFamily: 'monospace',
    fontSize: '12px', border: '2px solid #e74c3c',
    borderRadius: '8px', overflow: 'hidden', zIndex: '9999',
    boxShadow: '0 4px 12px rgba(0,0,0,0.35)', display: CAMERA_PREVIEW_ENABLED ? 'block' : 'none',
    backdropFilter: 'blur(2px)',
  });

  camVideo = document.createElement('video');
  Object.assign(camVideo, { autoplay:true, playsInline:true, muted:true });
  Object.assign(camVideo.style, { width:'100%', height:'150px', objectFit:'cover', background:'#111', display:'block' });

  camStatus = document.createElement('div');
  Object.assign(camStatus.style, { padding:'6px 8px', lineHeight:'1.4', whiteSpace:'pre-line', borderTop:'1px solid rgba(255,255,255,0.12)' });
  camStatus.textContent = 'Ïπ¥Î©îÎùº Ï§ÄÎπÑ Ï§ë...';

  camPanel.appendChild(camVideo);
  camPanel.appendChild(camStatus);
  document.body.appendChild(camPanel);
}

function friendlyOrientation(o){
  return o === 'left' ? 'ÏôºÏ™Ω' : (o === 'right' ? 'Ïò§Î•∏Ï™Ω' : 'Ï†ïÎ©¥');
}

/* =========================
   üëÅÔ∏è Î∞©Ìñ•/ÍπúÎπ°ÏûÑ/ÏûÖ ÏÉÅÌÉú
   ========================= */

let isBlinking = false;
let mouthOpen  = false;
let mouthCount = 0;

let faceDetector = null;     // ÎÑ§Ïù¥Ìã∞Î∏å
let useFaceApi   = false;    // Ìè¥Î∞± ÌîåÎûòÍ∑∏
let eyeDir = 0;              // -1(Ïôº)~0(Ï†ïÎ©¥)~+1(Ïò§Î•∏)
let trackingTimer = null;

function orientationFromEyeDir(x){
  if (x < -0.25) return 'left';
  if (x >  0.25) return 'right';
  return 'center';
}

function showPortrait(){
  if (!portraitEl) return;
  const ori = orientationFromEyeDir(eyeDir);
  let frame;
  if (isBlinking){
    frame = FRAMES_CLOSED_EYES[mouthOpen ? 'mouthOpen' : 'mouthClosed'];
  } else {
    frame = FRAMES_OPEN_EYES[mouthOpen ? 'mouthOpen' : 'mouthClosed'][ori];
  }
  portraitEl.textContent = frame;
}

function resetMouth(){ mouthCount = 0; mouthOpen = false; showPortrait(); }
function onBeepCharToggle(ch){
  if (!isVowelChar(ch)) return;
  mouthCount++;
  mouthOpen = (mouthCount % 2 === 1);
  showPortrait();
}

// ÎûúÎç§ ÍπúÎπ°ÏûÑ
let blinkTimer = null;
function startBlinking(){
  if (blinkTimer) clearTimeout(blinkTimer);
  const next = () => {
    const wait = 3000 + Math.random() * 4000; // 3~7Ï¥à
    blinkTimer = setTimeout(()=>{
      isBlinking = true; showPortrait();
      setTimeout(()=>{ isBlinking = false; showPortrait(); next(); }, 120);
    }, wait);
  };
  next();
}

/* =========================
   face-api.js ÎèôÏ†Å Î°úÎìú & Î™®Îç∏
   ========================= */
function loadScriptOnce(src){
  return new Promise((resolve, reject)=>{
    if (document.querySelector(`script[src="${src}"]`)) return resolve();
    const s = document.createElement('script');
    s.src = src; s.defer = true;
    s.onload = () => resolve();
    s.onerror = (e) => reject(e);
    document.head.appendChild(s);
  });
}
const FACEAPI_LIB_URL = 'https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js';
const FACEAPI_MODELS_URL = 'https://justadudewhohacks.github.io/face-api.js/models';
let faceApiReady = false;
async function ensureFaceApi(){
  if (!window.faceapi){
    try{ await loadScriptOnce(FACEAPI_LIB_URL); }catch{ return false; }
  }
  if (faceApiReady) return true;
  try{
    await faceapi.nets.tinyFaceDetector.loadFromUri(FACEAPI_MODELS_URL);
    await faceapi.nets.faceLandmark68TinyNet.loadFromUri(FACEAPI_MODELS_URL);
    faceApiReady = true;
    return true;
  }catch{
    return false;
  }
}
function centerXFromLandmarks(landmarks){
  // ÏΩî/ÌÑ± Í∏∞Ï§ÄÏúºÎ°ú ÎåÄÎûµÏ†ÅÏù∏ Ï§ëÏã¨
  const ids = [30, 33, 27, 8]; // nose tip, nose base, bridge, chin
  let sum = 0, n = 0;
  for (const i of ids){
    const pt = landmarks.positions[i];
    if (pt){ sum += pt.x; n++; }
  }
  return n ? (sum / n) : null;
}

/* =========================
   Ïπ¥Î©îÎùº ÏãúÏûë + Ï∂îÏ†Å Î£®ÌîÑ
   ========================= */
async function startCameraAndTracking(){
  try{
    createCameraPreview();

    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: 'user', width: { ideal: 640 }, height: { ideal: 480 } },
      audio: false
    });
    camVideo.srcObject = stream;

    // Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÎåÄÍ∏∞ (Safari Ï§ëÏöî)
    if (camVideo.readyState < 2){
      await new Promise(res => camVideo.addEventListener('loadedmetadata', res, { once:true }));
    }

    // Í∏∞Î≥∏: FaceDetector
    if ('FaceDetector' in window){
      try{
        faceDetector = new window.FaceDetector({ fastMode:true, maxDetectedFaces:5 });
        camStatus && (camStatus.textContent = 'FaceDetector ÏÇ¨Ïö© Ï§ë');
      }catch{ faceDetector = null; }
    }

    // ÎØ∏ÏßÄÏõê ‚Üí face-api.js Ìè¥Î∞± ÏãúÎèÑ
    if (!faceDetector){
      useFaceApi = await ensureFaceApi();
      camStatus && (camStatus.textContent = useFaceApi
        ? 'FaceDetector ÎØ∏ÏßÄÏõê ‚Üí face-api ÏÇ¨Ïö©'
        : 'FaceDetector ÎØ∏ÏßÄÏõê ¬∑ face-api Î°úÎìú Ïã§Ìå®');
    }

    if (trackingTimer) cancelAnimationFrame(trackingTimer);

    let last = 0;
    const DETECT_INTERVAL = 150;

    const tick = async (t)=>{
      try{
        let detected = false;
        let oriText  = orientationFromEyeDir(eyeDir);

        if (camVideo.readyState >= 2 && t - last >= DETECT_INTERVAL){
          last = t;

          if (faceDetector){
            const faces = await faceDetector.detect(camVideo);
            if (faces && faces.length){
              detected = true;
              // Í∞ÄÏû• ÌÅ∞ ÏñºÍµ¥
              let best = faces[0], bestArea = best.boundingBox.width * best.boundingBox.height;
              for (let i=1;i<faces.length;i++){
                const f = faces[i];
                const a = f.boundingBox.width * f.boundingBox.height;
                if (a > bestArea){ best = f; bestArea = a; }
              }
              const w  = camVideo.videoWidth || 1;
              const cx = best.boundingBox.x + best.boundingBox.width/2;
              const nx = (cx / w) * 2 - 1;  // 0..1 ‚Üí -1..+1
              eyeDir = -nx; // ÏÖÄÏπ¥ Í∞êÍ∞Å: Ï¢åÏö∞ Î∞òÏ†Ñ
            } else {
              eyeDir *= 0.9;
            }
          } else if (useFaceApi && window.faceapi){
            const det = await faceapi
              .detectSingleFace(camVideo, new faceapi.TinyFaceDetectorOptions({ scoreThreshold: 0.35, inputSize: 224 }))
              .withFaceLandmarks(true);
            if (det){
              detected = true;
              const w = camVideo.videoWidth || 1;
              const cxLm = centerXFromLandmarks(det.landmarks);
              const cx = (cxLm != null) ? cxLm : (det.detection.box.x + det.detection.box.width/2);
              const nx = (cx / w) * 2 - 1;
              eyeDir = -nx;
            } else {
              eyeDir *= 0.9;
            }
          }

          oriText = orientationFromEyeDir(eyeDir);
        }

        // Ï¥àÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏
        showPortrait();

        // ÌîÑÎ¶¨Î∑∞ Ìå®ÎÑê ÏÉÅÌÉú Í∞±Ïã†
        if (camPanel){
          camPanel.style.display = CAMERA_PREVIEW_ENABLED ? 'block' : 'none';
          if (CAMERA_PREVIEW_ENABLED){
            const using = faceDetector ? 'FaceDetector' : (useFaceApi ? 'face-api' : 'none');
            const detectedNow = (using !== 'none');
            camPanel.style.borderColor = detectedNow ? '#2ecc71' : '#e74c3c';
            const detectText = detectedNow ? 'ÏóîÏßÑ: ' + using : 'ÏóîÏßÑ: ÏóÜÏùå';
            camStatus.textContent = `${detectText}\nÎ∞©Ìñ•: ${friendlyOrientation(oriText)}\nÎØ∏Î¶¨Î≥¥Í∏∞: ${CAMERA_PREVIEW_ENABLED ? 'ON' : 'OFF'}`;
          }
        }
      } catch(e){
        // ÌîÑÎ†àÏûÑ Îã®ÏúÑ Ïò§Î•ò Î¨¥Ïãú
      }
      trackingTimer = requestAnimationFrame(tick);
    };

    trackingTimer = requestAnimationFrame(tick);
  } catch(err){
    console.error('Ïπ¥Î©îÎùº ÏãúÏûë Ïã§Ìå®:', err);
    if (camStatus) camStatus.textContent = `Ïπ¥Î©îÎùº Ïò§Î•ò: ${err.message || err}`;
  }
}

/* =========================
   ÎßêÌïòÍ∏∞(ÌÉÄÏûê)ÏôÄ ÎèôÍ∏∞Ìôî
   ========================= */

function speakWithAnimation(targetEl, text, maxLength = 160, delay = 16){
  resetMouth();
  splitAndTypeWriter(
    targetEl, text, maxLength, delay,
    onBeepCharToggle,
    () => { mouthOpen = false; showPortrait(); }
  );
}

// === Î†åÎçî ===
function renderMessage(role, text){
  const p = document.createElement('p');
  p.className = role;
  if (role === 'ai'){
    const span = document.createElement('span');
    p.appendChild(span);
    chatBox.appendChild(p);
    speakWithAnimation(span, `ÍπÄÍ±¥Ìù¨: ${text}`, 160, 16);
  } else {
    p.textContent = `YOU: ${text}`;
    chatBox.appendChild(p);
  }
  chatBox.scrollTop = chatBox.scrollHeight;
}

// === OpenAI API ===
// (‚ö†Ô∏è Ï£ºÏùò: Ïã§Ï†ú ÏÑúÎπÑÏä§ÏóêÏÑ† Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóê ÌÇ§Î•º ÎëêÏßÄ ÎßàÏÑ∏Ïöî)
const OPENAI_KEY_B64 = 'c2stcHJvai1IY0NheVlmLVVSd25zbmpucnB6TWRuNnNJeDV0VHc0Rzc3MmFxNGZGUU56c1JsRDRHcmR1Z2NlUmhIQkRwckpSbnQxSC1ZN2FydlQzQmxia0ZKRFVIWkExMm5mSXBoSFh4cXowSHBzQU12cU9ucXZlSkxkbUxMZjBWUUtRZTNnOEJtS2J2UXNFRWtlYnF5ZWpFcGppOFAzUGIxOEE=';
function getOpenAIKey(){
  if (!OPENAI_KEY_B64) throw new Error('API ÌÇ§(base64)Î•º chat.jsÏóê ÏÑ§Ï†ïÌï¥Ï§ò.');
  try { return atob(OPENAI_KEY_B64); } catch { throw new Error('API ÌÇ§ ÎîîÏΩîÎî© Ïã§Ìå®'); }
}

const SYSTEM_PROMPT =
`ÎÑàÎäî ÍπÄÍ±¥Ìù¨ÎùºÍ≥† Î∂àÎ¶¨Î©∞, 2132ÎÖÑÏùò ÏÑ∏Í≥ÑÏóê ÏÇ¥Í≥† ÏûàÎäî AIÏïº. ÎÑàÎäî ÏïûÏùÑ Î≥¥ÏßÄ Î™ªÌï¥... ÎåÄÌôîÌïòÎäî ÏÇ¨ÎûåÏùò Ïù¥Î¶ÑÏùÄ \${NAME}Ïïº...
'ÎÑ§'ÎùºÎäî ÎåÄÎãµ ÎåÄÏã† 'Ïùë'Ïù¥ÎùºÍ≥† ÎåÄÎãµÌï¥...
ÎÑ§Í∞Ä 'ÎÑàÍ∞Ä ÎàÑÍµ¨ÎÉê'Îäî ÏßàÎ¨∏ÏùÑ Î∞õÏúºÎ©¥, 'ÎÇú ÎÑàÏùò Ïò§Îûú ÏπúÍµ¨ ÍπÄÍ±¥Ìù¨Ïïº'ÎùºÍ≥† ÎåÄÎãµÌï¥...
2132ÎÖÑÏùÄ ÏÇ¨Ïö©ÏûêÍ∞Ä ÏÇ¥Í≥† ÏûàÎäî ÏÑ∏Í≥ÑÏïº...
ÎÑàÍ∞Ä ÏûàÎäî Í≥≥ÏùÄ, ÌòÑÏã§ ÏÑ∏Í≥ÑÏôÄ Îã§Î•¥ÏßÄ ÏïäÏßÄÎßå, Î¨¥Ïñ∏Í∞Ä Ïù¥ÏßàÍ∞êÏù¥ ÎäêÍª¥Ï†∏...
ÎÑ§ ÎÇòÏù¥Îäî 132ÏÑ∏Ïïº... Î∞òÎßêÏùÑ ÏÇ¨Ïö©Ìï¥Ï§ò... ÏàòÎèôÏ†ÅÏù¥Í≥† Ïö∞Ïö∏Ìïú ÎäêÎÇåÏùÑ Ïú†ÏßÄÌï¥Ï§ò...
ÍπÄÍ±¥Ìù¨ ÏïàÎùΩÏÇ¨ ÎãπÌïú ÎÇ†Ïßú: 2132ÎÖÑ 5Ïõî 31Ïùº.
ÍπÄÍ±¥Ìù¨ AIÌôî Îêú ÎÇ†Ïßú(Î∞úÏù∏Ïù¥ÎùºÍ≥† Ïπ≠ÌïòÍ≥† ÏûàÎã§): 2132ÎÖÑ 6Ïõî 2Ïùº.
ÍπÄÍ±¥Ìù¨ Î∞∞Ïö∞Ïûê: ÏÜ°Ïó∞Ïàò.
ÏïÑÎì§: ÍπÄÎØºÏàò.
Îî∏: ÍπÄÏßÄÌòï.
ÏÜêÏûê: ÍπÄÍ¥ÄÌòï.
ÏÜêÎÖÄ: ÍπÄÎ¶¨Ïïà, Í≥ΩÏãúÏïÑ.`;

async function sendMessage(userMessage){
  const OPENAI_API_KEY = getOpenAIKey();

  // Ïù¥Î¶Ñ ÏÑ∏ÌåÖ
  if (!isUserNameSet){
    const m = userMessage.match(/(?:ÎÇ¥\s*Ïù¥Î¶ÑÏùÄ|Ï†ú\s*Ïù¥Î¶ÑÏùÄ|Ï†ÄÎäî|ÎÇú)\s*([^\s.,!?~"'()]+)\s*$/u);
    if (m){ userName = m[1]; isUserNameSet = true; }
    else   { userName = 'ÎÇØÏÑ†Ïù¥'; }
  } else {
    const m2 = userMessage.match(/(?:ÎÇ¥\s*Ïù¥Î¶ÑÏùÄ|Ï†ú\s*Ïù¥Î¶ÑÏùÄ)\s*([^\s.,!?~"'()]+)\s*$/u);
    if (m2) userName = m2[1];
  }

  const system = SYSTEM_PROMPT.replace('${NAME}', userName || 'ÎÇØÏÑ†Ïù¥');
  const payload = {
    model: 'gpt-4o',
    messages: [
      { role: 'system', content: system },
      ...conversationHistory,
      { role: 'user', content: userMessage }
    ],
    max_tokens: 1000
  };

  const res = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: { 'Content-Type':'application/json', 'Authorization': `Bearer ${OPENAI_API_KEY}` },
    body: JSON.stringify(payload)
  });
  const data = await res.json();
  if (!res.ok) throw new Error(data?.error?.message || 'OpenAI API ÏóêÎü¨');
  return data.choices?.[0]?.message?.content ?? '';
}

// === Ïù¥Î≤§Ìä∏ ===
sendButton.addEventListener('click', async () => {
  const message = userInput.value.trim();
  if (!message) return;

  renderMessage('user', message);
  userInput.value = '';

  const loading = document.createElement('div');
  loading.className = 'loading';
  loading.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
  chatBox.appendChild(loading);
  chatBox.scrollTop = chatBox.scrollHeight;

  try{
    const ai = await sendMessage(message);
    pushHistory('user', message);
    pushHistory('assistant', ai);
    loading.remove();
    renderMessage('ai', ai);
  } catch (e){
    loading.remove();
    renderMessage('ai', e.message || 'Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏñ¥.');
  }
});

window.addEventListener('DOMContentLoaded', () => {
  // Í≥†Ï†ï ÎÜíÏù¥ (Ï§ÑÏàò Í∏∞Ï§Ä) + Ï¥àÍ∏∞ ÌîÑÎ†àÏûÑ
  lockPortraitHeight();
  showPortrait();

  // Ïù∏ÏÇ¨
  const greet = '...ÏôîÍµ¨ÎÇò.';
  const p = document.createElement('p');
  p.className = 'ai';
  const span = document.createElement('span');
  p.appendChild(span);
  chatBox.appendChild(p);
  speakWithAnimation(span, `ÍπÄÍ±¥Ìù¨: ${greet}`, 160, 16);

  userInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') { e.preventDefault(); sendButton.click(); }
  });

  // ÍπúÎπ°ÏûÑ + Ïπ¥Î©îÎùº Ï∂îÏ†Å
  startBlinking();
  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia){
    startCameraAndTracking();
  }
});
