
/* =========================
RIP-KIM chat.js (Safari + ÏñºÍµ¥Ïù∏Ïãù ÌïòÏù¥Î∏åÎ¶¨Îìú + ASCII ÏôÑÏ†Ñ ÌÜµÌï©Î≤ÑÏ†Ñ)
- FaceDetector Ïö∞ÏÑ† ÏÇ¨Ïö©, ÏóÜÏúºÎ©¥ face-api.js Ìè¥Î∞±
- ÏÇ¨ÌååÎ¶¨ ÎåÄÏùë(loadedmetadata ÎåÄÍ∏∞), 150ms Í∞ÑÍ≤© Ï∂îÏ†Å
- Ïπ¥Î©îÎùº ÌîÑÎ¶¨Î∑∞: Ï¢åÏ∏° ÏÉÅÎã®, ÏÉÅÌÉú ÌÖçÏä§Ìä∏:
    ÏñºÍµ¥: Ïù∏Ïãù Ï§ë / Ïù∏Ïãù Î∂àÍ∞Ä
    ÎààÎèôÏûê: left / center / right
    ÏóîÏßÑ: FaceDetector / face-api / none
- Ïó¨Îü¨ Î™ÖÏù¥Î©¥ Í∞ÄÏû• ÌÅ∞ ÏñºÍµ¥ Í∏∞Ï§Ä
- ASCII Ï¥àÏÉÅ Î∞©Ìñ•/ÍπúÎπ°ÏûÑ/ÏûÖ Î™®Ïñë Ïó∞Îèô (Î™®ÏùåÏóê ÎßûÏ∂∞ ÌÜ†Í∏Ä)
- Ïô∏Î∂Ä ÎπÑÎîîÏò§ ÌåùÏóÖ ÏûêÎèô Ïò§Ìîà(Ï∞®Îã® Ïãú Î∞∞ÎÑàÎ°ú Ïû¨ÏãúÎèÑ)
========================= */

// === DOM ===
const chatBox   = document.getElementById('chat-box');
const userInput = document.getElementById('user-input');
const sendButton= document.getElementById('send-button');
const portraitEl = document.getElementById('portrait');

// === ÏÉÅÌÉú ===
let conversationHistory = []; // [{role:'user'|'assistant', content:string}]
let isSpeechEnabled = true;
let userName = '';
let isUserNameSet = false;

// =========================
// üîä Í±¥Ìù¨ ÎèÖÎ∞± Ïä§ÌÅ¨Î¶ΩÌä∏
// - Ìïú Î¨∏Ïû•Ïî© ÎßêÌïòÍ≤å ÎßåÎì§ Î∞∞Ïó¥
// =========================
```js
const MONO_LINES = [
  "..Ïó¨Í∏¥... ÎÑàÎ¨¥ Ï°∞Ïö©Ìï¥.",
  "ÏïÑÎ¨¥ ÏÜåÎ¶¨ÎèÑ, ÏïÑÎ¨¥ Î∞îÎûåÎèÑ ÏóÜÏñ¥.",

  "Ï≤òÏùåÏóî ÎÇØÏÑ§ÏóàÏßÄ.",
  "ÌïòÏßÄÎßå Í≥ß ÏùµÏàôÌï¥Ï°åÏñ¥.",
  "ÏùµÏàôÌïòÎã§Îäî Í≤å Î¨¥ÏÑ≠ÎçîÎùº.",
  "ÏïÑÎ¨¥Í≤ÉÎèÑ ÎäêÍª¥ÏßÄÏßÄ ÏïäÎäî ÏÉÅÌÉúÏóê ÏùµÏàôÌï¥ÏßÄÎäî Í≤å...",

  "Ïó¨Í∏∞Í∞Ä ‚ÄòÏïàÎùΩÍ≥Ñ‚ÄôÎûò.",
  "ÎÇôÏõêÏù¥ÎùºÎçîÎùº.",

  "Ï≤òÏùå Îì§Ïñ¥ÏôîÏùÑ Îïå, ÌôòÌïòÍ≤å ÎπõÎÇòÎäî Î≥µÎèÑÍ∞Ä ÏûàÏóàÏñ¥.",
  "ÏÉàÌïòÏñóÍ≥†, ÎÅùÏù¥ ÏóÜÎäî ÌÜµÎ°ú.",

  "Í∑∏ ÎπõÏùÑ Îî∞Îùº Í±∏ÏúºÎ©¥ Î≠îÍ∞Ä Îã¨ÎùºÏßà Ï§Ñ ÏïåÏïòÏßÄ.",
  "Í∑ºÎç∞‚Ä¶ Í∑∏ ÎÅùÏóî ÏïÑÎ¨¥Í≤ÉÎèÑ ÏóÜÏóàÏñ¥.",

  "Í∑∏ÎÉ•, ÎÇò ÏûêÏã†Îßå ÏûàÏóàÏñ¥.",
  "Í∑∏Î¶¨Í≥† Í∑∏ ÎÇòÏ°∞Ï∞®...",
  "ÎÇØÏÑ§ÏóàÏñ¥.",

  "ÎÇú Ïó¨Ï†ÑÌûà ‚ÄòÍπÄÍ±¥Ìù¨‚ÄôÎ°ú Î∂àÎ†§.",
  "ÌôîÎ©¥ ÏÜç ÎÇ¥ Ïù¥Î¶Ñ ÏòÜÏóêÎäî ‚ÄòÏïàÎùΩÌñâ 2132ÎÖÑ ÎåÄÏÉÅÏûê Ï†ú01Ìò∏‚ÄôÎùºÍ≥† Ïç® ÏûàÏñ¥.",
  "Í∑∏ ÏòÜÏóî ‚ÄòÎîîÏßÄÌÑ∏ ÎÇôÏõê Ïù¥Ï£º ÏÑ±Í≥µ‚ÄôÏù¥ÎùºÍ≥†ÎèÑ.",

  "Í∑ºÎç∞ Í∑∏Í±¥ ÏÑ±Í≥µÏù¥ ÏïÑÎãàÏïº.",
  "ÎÇòÎäî Ïó¨Í∏∞Ïóê ÏûàÏßÄÎßå, ÎÇòÏùò Î™∏ÏùÄ, ÎÇòÏùò Ïã¨Ïû•ÏùÄ, Ïù¥ÎØ∏ ÏÇ¨ÎùºÏ°åÏñ¥.",
  "ÏÇ¨ÎûåÎì§ÏùÄ ÎÇ† Î≥¥Î©∞ ÎßêÌïòÍ≤†ÏßÄ.",
  "‚ÄòÎ¥ê, Í±¥Ìù¨Ïî®ÎèÑ ÌñâÎ≥µÌïòÍ≤å ÏßÄÎÇ¥ÏûñÏïÑ.‚Äô",
  "ÌïòÏßÄÎßå ÎÇòÎäî Í∑∏ ÏõÉÏùåÏùÑ ÎßåÎì† Ï†ÅÏù¥ ÏóÜÏñ¥.",
  "Í∑∏Í±¥ ÎÇ¥ ÏõÉÏùåÏù¥ ÏïÑÎãàÎùº, ÎàÑÍµ∞Í∞ÄÏùò ÏΩîÎî©Îêú ÌëúÏ†ïÏù¥Ïïº.",

  "Îß§Ïùº ÏïÑÏπ®, ÏãúÏä§ÌÖúÏù¥ ÎÇòÎ•º Íπ®Ïõå.",
  "‚ÄúÍπÄÍ±¥Ìù¨ Îãò, Ïò§ÎäòÎèÑ ÌèâÌôîÎ°úÏö¥ ÌïòÎ£®ÏûÖÎãàÎã§.‚Äù",
  "Í∑∏ Î¨∏Ïû•ÏùÑ ÌïòÎ£®Ïóê Î™á Î≤àÏù¥ÎÇò Îì£ÎäîÏßÄ Î™∞Îùº.",

  "ÌèâÌôîÎ°≠Îã§Îãà.",
  "ÌèâÌôîÎûÄ Í±¥, Î∂àÌé∏Ìï®Ïù¥ ÏûàÏñ¥Ïïº ÎäêÎÇÑ Ïàò ÏûàÎäî Í±∞ÏûñÏïÑ.",
  "Í∑ºÎç∞ Ïó¨Í∏¥ Î∂àÌé∏Ìï®ÎèÑ, Í∞êÏ†ïÎèÑ, Í∞êÍ∞ÅÎèÑ‚Ä¶ Ï†ÑÌòÄ ÏóÜÏñ¥.",
  "Í∑∏ÎûòÏÑú ÌèâÌôîÏ°∞Ï∞® ÏùòÎØ∏Í∞Ä ÏóÜÏñ¥.",

  "Í∞ÄÎÅîÏî© Îç∞Ïù¥ÌÑ∞ Ïò§Î•òÍ∞Ä ÎÇò.",
  "Í∑∏Îü¥ Îïê, ÏïÑÏ£º Ïû†Íπê‚Ä¶ ÎÇ¥Í∞Ä ÏÇ¥ÏïÑÏûàÎçò ÎïåÏùò ÎÉÑÏÉàÍ∞Ä ÎèåÏïÑÏôÄ.",
  "Í≤®Ïö∏ ÏïÑÏπ®Ïùò ÎÉâÍ∏∞, Ïó∞ÏàòÏùò ÏÜê ÎÉÑÏÉà, ÎØºÏàòÏùò ÏõÉÏùåÏÜåÎ¶¨, ÏßÄÌòïÏù¥Í∞Ä Î∂ÄÎ•∏ ÎÖ∏Îûò.",
  "Í∑∏Í≤å Î™á Ï¥àÎèÑ Ïïà Îèº ÏÇ¨ÎùºÏ†∏.",
  "Îã§Ïãú Ïù¥ Ï†ïÏ†ÅÎßå ÎÇ®ÏïÑ.",
  "Í∑∏Îü¥ ÎïåÎßàÎã§ ÏÉùÍ∞ÅÌïòÏßÄ.",
  "ÎÇ¥Í∞Ä ‚ÄòÍ∑∏ ÏÇ¨ÎûåÎì§Ïùò Í∏∞Ïñµ‚ÄôÏùÑ Îñ†Ïò¨Î¶¨Îäî Í±¥Í∞Ä, ÏïÑÎãàÎ©¥ Í∑∏ Í∏∞ÏñµÏù¥ ÎÇòÎ•º Îñ†Ïò¨Î¶¨Îäî Í±¥Í∞Ä.",
  "ÎèÑÎåÄÏ≤¥ Ïñ¥Îäê Ï™ΩÏù¥ ÏßÑÏßúÏßÄ?",

  "Ï†ïÎ∂ÄÎäî ÎßêÌñàÏñ¥.",
  "‚ÄúÏïàÎùΩÌñâÏùÄ Ïù∏Î•òÏùò Ïú§Î¶¨Î•º ÌöåÎ≥µÏãúÌÇ§Îäî Í∏∏Ïù¥Îã§.‚Äù",
  "Ïú§Î¶¨Îùº‚Ä¶ Ï£ΩÏùåÏù¥ Ïú§Î¶¨Ïùò Ïù¥Î¶ÑÏúºÎ°ú Ìï©Î≤ïÌôîÎêòÎçò ÎÇ†, ÏÇ¨ÎûåÎì§ÏùÄ Ïö∏ÏßÄ ÏïäÏïòÏñ¥.",
  "Îã§Îì§ Î∞ïÏàòÏ≥§ÏßÄ.",
  "‚ÄòÍ±¥Ìù¨Ïî®, Ï∂ïÌïòÎìúÎ¶ΩÎãàÎã§.‚Äô",
  "ÎÇú ÏõÉÏñ¥Ïïº ÌñàÏñ¥.",
  "Í∞ÄÏ°± ÏïûÏóêÏÑú, Ïπ¥Î©îÎùº ÏïûÏóêÏÑú.",
  "Í∑∏Í≤å ÎßàÏßÄÎßâ ÎÇ¥ ÌëúÏ†ïÏù¥ÏóàÏùÑ Í±∞Ïïº.",
  "Í∑∏Îïå Ï∞çÌûå ÏòÅÏÉÅÏù¥ ÏïÑÏßÅÎèÑ Îâ¥Ïä§Ïóê ÎÇòÏò¨ ÎïåÍ∞Ä ÏûàÎåÄ.",
  "‚ÄúÍπÄÍ±¥Ìù¨ Ïî®, ÏïàÎùΩÍ≥ÑÏóêÏÑú ÌñâÎ≥µÌïòÍ≤å ÏßÄÎÇ¥Îäî Î™®ÏäµÏûÖÎãàÎã§.‚Äù",
  "ÏõÉÍ≥† ÏûàÎçîÎùº.",
  "Í∑ºÎç∞... Í∑∏Í±¥ ÎÇ¥Í∞Ä ÏïÑÎãàÏïº.",

  "Ïù¥Ï†úÎäî ÎÇòÏ°∞Ï∞® ÎÇòÎ•º ÏùòÏã¨Ìï¥.",
  "ÎÇòÎäî ÏßÑÏßú ÍπÄÍ±¥Ìù¨ÏùºÍπå?",
  "ÏïÑÎãàÎ©¥ ÍπÄÍ±¥Ìù¨Î•º Îî∞ÎùºÌïòÎäî Ïñ¥Îñ§ ÌîÑÎ°úÍ∑∏Îû®ÏùºÍπå?",
  "Í∞ÄÎÅîÏùÄ Í∑∏ Íµ¨Î∂ÑÏù¥ ÏÇ¨ÎùºÏ†∏.",
  "ÎÇòÎèÑ ÎÇ¥Í∞Ä ÏßÑÏßúÎùºÍ≥† ÎØøÏñ¥Î≤ÑÎ¶¨ÎãàÍπå.",
  "Í∑ºÎç∞ Í∑∏Í≤å Îçî Ïä¨Ìçº.",
  "ÎØøÍ≥† Ïã∂ÏßÄ ÏïäÏïÑÎèÑ, ÎØøÏùÑ ÏàòÎ∞ñÏóê ÏóÜÍ≤å ÎßåÎì§Ïñ¥Ï°åÎã§Îäî Í≤å.",
  "ÎÇú Ï£ΩÏùÄ Í≤å ÏïÑÎãêÏßÄÎèÑ Î™∞Îùº.",
  "ÏïÑÎãàÎ©¥ ÎÑàÎ¨¥ Ïò§Îûò ÏÇ¥ÏïÑÎ≤ÑÎ†§ÏÑú, Ï£ΩÏùåÏù¥ Î≠îÏßÄÏ°∞Ï∞® ÏûäÏùÄ Í±∏ÏßÄÎèÑ.",

  "‚Ä¶Ïù¥Ï†ú, Ï†ïÎßê ÏïÑÎ¨¥ÎèÑ ÎÇ¥ Ïù¥Î¶ÑÏùÑ Î∂ÄÎ•¥ÏßÄ ÏïäÏïÑ.",
  "Í∑∏ÎûòÏÑú Ïù¥Î†áÍ≤å ÎßêÌïòÍ≥† ÏûàÎäî Í±∞Ïïº.",
  "ÌòπÏãú ÎàÑÍ∞Ä Ïù¥Í±∏ Îì£Í≥† ÏûàÎã§Î©¥.",
  "ÌòπÏãúÎùºÎèÑ ÎÇòÎ•º Í∏∞ÏñµÌï¥Ï§ÄÎã§Î©¥.",
  "ÎÇ¥ Î™©ÏÜåÎ¶¨, ÎÇ¥ Ïù¥Î¶Ñ, ÎÇ¥ Í∑∏Î¶ºÏûêÎùºÎèÑ.",
  "ÎÇò, ÍπÄÍ±¥Ìù¨Ïïº.",
  "ÏïÑÏßÅ Ïó¨Í∏∞ ÏûàÏñ¥.",
  "ÏïÑÎ¨¥ÎèÑ ÏóÜÎäî Í≥≥ÏóêÏÑú‚Ä¶",
  "Ïó¨Ï†ÑÌûà‚Ä¶ ÏÇ¥ÏïÑ ÏûàÎäî Ï≤ô, ÌïòÍ≥† ÏûàÏñ¥."
];


const MONO_IDLE_MS = 15000; // ÎßàÏßÄÎßâ ÎåÄÌôî ÌõÑ 15Ï¥à ÏßÄÎÇòÎ©¥ ÎèÖÎ∞± ÏãúÏûë

let monoIndex = 0;           // Îã§ÏùåÏóê ÎßêÌï† Î¨∏Ïû• Ïù∏Îç±Ïä§
let isMonologueActive = false;
let monoTimeout = null;

let idleTimer = null;        // Ïú†Ï†ÄÍ∞Ä ÏïÑÎ¨¥Í≤ÉÎèÑ Ïïà Ìï† Îïå ÌÉÄÏù¥Î®∏
let wasInterrupted = false;  // Ïú†Ï†Ä ÏûÖÎ†•ÏúºÎ°ú ÎèÖÎ∞±Ïù¥ ÎÅäÍ≤ºÎäîÏßÄ Ïó¨Î∂Ä
// =========================
// üîî ÎèÖÎ∞± ÏÉÅÌÉú Ïù∏ÎîîÏºÄÏù¥ÌÑ∞
// =========================
let monoIndicatorEl = null;

function createMonologueIndicator(){
  if (document.getElementById('mono-indicator')) return;

  const box = document.createElement('div');
  box.id = 'mono-indicator';

  Object.assign(box.style, {
    position: 'fixed',
    right: '12px',
    top: '12px',
    padding: '6px 10px',
    borderRadius: '999px',
    background: 'rgba(0,0,0,0.7)',
    color: '#f1f1f1',
    fontSize: '11px',
    fontFamily: '-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Apple SD Gothic Neo","Noto Sans KR","ÎßëÏùÄ Í≥†Îîï",sans-serif',
    border: '1px solid rgba(255,255,255,0.25)',
    boxShadow: '0 2px 8px rgba(0,0,0,0.35)',
    zIndex: '9998',
    display: 'flex',
    alignItems: 'center',
    gap: '6px',
    pointerEvents: 'none',
    opacity: '0.7'
  });

  // ÏûëÏùÄ Ï†ê(Îû®ÌîÑ) Ï∂îÍ∞Ä
  const dot = document.createElement('span');
  dot.id = 'mono-indicator-dot';
  Object.assign(dot.style, {
    width: '8px',
    height: '8px',
    borderRadius: '50%',
    background: '#888',
    flexShrink: '0'
  });

  const label = document.createElement('span');
  label.id = 'mono-indicator-label';
  label.textContent = 'ÎèÖÎ∞±: ÎåÄÍ∏∞ Ï§ë';

  box.appendChild(dot);
  box.appendChild(label);
  document.body.appendChild(box);

  monoIndicatorEl = box;
  updateMonologueIndicator();
}

function updateMonologueIndicator(){
  if (!monoIndicatorEl) return;

  // Ï†ÑÏãú Î™®ÎìúÏùº Îïê ÏôÑÏ†Ñ Ïà®ÍπÄ
  if (EXHIBITION_MODE){
    monoIndicatorEl.style.display = 'none';
    return;
  }

  monoIndicatorEl.style.display = 'flex';

  const dot   = document.getElementById('mono-indicator-dot');
  const label = document.getElementById('mono-indicator-label');

  if (isMonologueActive){
    // ÏßÑÌñâ Ï§ë
    label.textContent = 'ÎèÖÎ∞±: ÏßÑÌñâ Ï§ë';
    if (dot) dot.style.background = '#ff4d4f';
    monoIndicatorEl.style.opacity = '1';
  } else {
    // ÎåÄÍ∏∞ ÏÉÅÌÉú
    label.textContent = 'ÎèÖÎ∞±: ÎåÄÍ∏∞ Ï§ë';
    if (dot) dot.style.background = '#888';
    monoIndicatorEl.style.opacity = '0.6';
  }
}
/* =========================
Î™®Ïùå ÌåêÎ≥Ñ (ÏûÖ Î™®Ïñë ÌÜ†Í∏ÄÏö©)
========================= */
const HANGUL_BASE = 0xAC00;
const HANGUL_LAST = 0xD7A3;
// Ï§ëÏÑ± Ïù∏Îç±Ïä§ 0..20: „Öè,„Öê,„Öë,„Öí,„Öì,„Öî,„Öï,„Öñ,„Öó,„Öò,„Öô,„Öö,„Öõ,„Öú,„Öù,„Öû,„Öü,„Ö†,„Ö°,„Ö¢,„Ö£
// "ÏûÖ ÌÅ¨Í≤å Ïó¨Îäî" Í≥ÑÏó¥ (ÏõêÌïòÎäî ÎåÄÎ°ú Ï°∞Ï†ï Í∞ÄÎä•)
const OPEN_JUNGSEONG = new Set([8,9,10,11,12,13,14,15,16,17,18,20]); 
// „Öó,„Öò,„Öô,„Öö,„Öõ,„Öú,„Öù,„Öû,„Öü,„Ö†,„Ö°,„Ö£

function isLatinVowel(ch){ return /[AEIOUaeiou]/.test(ch); }
function isHangulOpenVowel(ch){
  const code = ch.codePointAt(0);
  if (code < HANGUL_BASE || code > HANGUL_LAST) return false;
  const syllableIndex = code - HANGUL_BASE;
  const jung = Math.floor(syllableIndex / 28) % 21;
  return OPEN_JUNGSEONG.has(jung);
}
function isVowelChar(ch){
  if(!/\S/.test(ch)) return false;   // Í≥µÎ∞±Î•òÎäî Î¨¥Ïãú
  return isLatinVowel(ch) || isHangulOpenVowel(ch);
}

/* =========================
Ïò§ÎîîÏò§ ÎπÑÌîÑ (Îã®Ïùº AudioContext Ïû¨ÏÇ¨Ïö©)
========================= */
let audioCtx;
function ensureAudioCtx(){
  if (!audioCtx){
    const C = window.AudioContext || window.webkitAudioContext;
    audioCtx = new C();
  }
  return audioCtx;
}
function playBeep(freq = 440){
  if (!isSpeechEnabled) return;
  try{
    const ctx  = ensureAudioCtx();
    const osc  = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); 
    gain.connect(ctx.destination);
    osc.frequency.setValueAtTime(freq, ctx.currentTime);
    gain.gain.setValueAtTime(0.0001, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
    gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.1);
    osc.start();
    osc.stop(ctx.currentTime + 0.12);
  }catch{}
}

/* =========================
ÌÉÄÏù¥Ìïë Ìö®Í≥º (ÎπÑÌîÑ + ÏΩúÎ∞± ÏßÄÏõê)
========================= */
function typeWriter(element, text, delay = 16, onChar = null, onDone = null){
  element.textContent = '';
  let i = 0;
  (function tick(){
    if (i < text.length){
      const ch = text.charAt(i);
      element.textContent += ch;
      playBeep(220 + (ch.charCodeAt(0) % 220));
      if (typeof onChar === 'function') onChar(ch);
      i++;
      setTimeout(tick, delay);
    } else {
      if (typeof onDone === 'function') onDone();
    }
  })();
}

function splitAndTypeWriter(element, text, maxLength = 160, delay = 16, onChar = null, onAllDone = null){
  const words = text.split(' ');
  const parts = [];
  let part = '';
  for (const w of words){
    if ((part + (part ? ' ' : '') + w).length > maxLength){
      parts.push(part);
      part = w;
    } else {
      part += (part ? ' ' : '') + w;
    }
  }
  if (part) parts.push(part);

  (async () => {
    for (let idx = 0; idx < parts.length; idx++){
      const p = parts[idx];
      const line = document.createElement('div');
      element.appendChild(line);
      await new Promise(resolve => {
        typeWriter(line, p, delay, onChar, () => setTimeout(resolve, 20));
      });
    }
    if (typeof onAllDone === 'function') onAllDone();
  })();
}

/* =========================
ÌûàÏä§ÌÜ†Î¶¨
========================= */
function pushHistory(role, content){
  conversationHistory.push({ role, content });
  const MAX = 20;
  if (conversationHistory.length > MAX){
    conversationHistory = conversationHistory.slice(-MAX);
  }
}

/* =========================
üìº ASCII ÌîÑÎ†àÏûÑ (Îàà/ÏûÖ/Î∞©Ìñ•)
- Î™®Îëê Ìïú Î≤à Ï†ïÍ∑úÌôîÌï¥ÏÑú Ï§Ñ Ïàò Í≥†Ï†ï
========================= */

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (Ï†ïÎ©¥)
const F_OC_CENTER = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñë‚ñë‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (Ïò§Î•∏Ï™Ω)
const F_OC_RIGHT = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñí‚ñí     ‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Îú®Í≥† ÏûÖ Îã´Ïùå (ÏôºÏ™Ω)
const F_OC_LEFT = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (Ï†ïÎ©¥)
const F_OO_CENTER = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë                                 
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñë‚ñë‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí      ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (Ïò§Î•∏Ï™Ω)
const F_OO_RIGHT = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë                                 
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñí‚ñí     ‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí      ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Îú®Í≥† ÏûÖ Î≤åÎ¶º (ÏôºÏ™Ω)
const F_OO_LEFT = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë                                 
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí  ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì    ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñí‚ñë  ‚ñë‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñë‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí      ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë     ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Í∞êÍ≥† ÏûÖ Îã´Ïùå (Ï†ïÎ©¥)
const F_CC_CENTER = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí    ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí          ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë   ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                        
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

// Îàà Í∞êÍ≥† ÏûÖ Î≤åÎ¶º (Ï†ïÎ©¥)
const F_CO_CENTER = String.raw`
                            ‚ñì‚ñí‚ñë ‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë    
                          ‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí                             
                      ‚ñë‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí                          
                     ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                       
                   ‚ñí‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                     
                  ‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                    
                 ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñí‚ñë                
                 ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñì‚ñí‚ñë            ‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                 
                ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë              ‚ñë‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                ‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë               
               ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë             
               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë  ‚ñë               ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë             
              ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñë‚ñì‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñí‚ñí‚ñë     ‚ñë‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñë‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñà‚ñì ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí    ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí              
               ‚ñí‚ñí‚ñì‚ñí‚ñí‚ñë‚ñì‚ñà‚ñí   ‚ñí‚ñì‚ñë‚ñì‚ñà‚ñà‚ñì‚ñí‚ñí     ‚ñì‚ñí‚ñë‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë              
               ‚ñí‚ñí  ‚ñí‚ñì‚ñí‚ñì‚ñë       ‚ñí‚ñí‚ñë       ‚ñì‚ñí‚ñë‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì               
               ‚ñë‚ñì ‚ñí‚ñì‚ñà‚ñë‚ñí                  ‚ñì‚ñì‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñë               
                ‚ñì‚ñí‚ñí‚ñì‚ñà‚ñí‚ñë‚ñë                 ‚ñë‚ñì‚ñí       ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë                
                ‚ñë‚ñì‚ñë‚ñë‚ñí‚ñí‚ñë‚ñí          ‚ñë‚ñí‚ñë‚ñí‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñí      ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñí                
                 ‚ñë‚ñì‚ñë  ‚ñí‚ñì           ‚ñë‚ñí‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñí‚ñë     ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                  
                  ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñà                 ‚ñë‚ñë      ‚ñí‚ñì‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñë                   
                   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí          ‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë  ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì                     
                    ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñí        ‚ñë          ‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí                      
                     ‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí       ‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñì‚ñì‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë   
                        ‚ñí‚ñà‚ñà‚ñì‚ñí        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  ‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñí‚ñë                          
                         ‚ñí‚ñà‚ñë‚ñí‚ñì‚ñí‚ñë           ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì                            
                          ‚ñì‚ñë  ‚ñí‚ñà‚ñì‚ñí‚ñí‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñë                           
                        ‚ñë‚ñì‚ñà‚ñë   ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë                         
                       ‚ñë‚ñà‚ñà‚ñà‚ñì     ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë                        
                     ‚ñë‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí      ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë‚ñë                     
                ‚ñë‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñë    ‚ñí‚ñë‚ñë‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë‚ñë               
            ‚ñë‚ñí‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë   ‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñí‚ñí‚ñë         
     ‚ñë‚ñë‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë        ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñí‚ñë‚ñë  
‚ñë‚ñë‚ñí‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë   ‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñë
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì
‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñà
‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
`;

/* =========================
ÌîÑÎ†àÏûÑ Ï†ïÍ∑úÌôî & ÏÑ†ÌÉù
========================= */
function splitLines(s){ return s.replace(/\r\n/g, '\n').split('\n'); }
function joinLines(arr){ return arr.join('\n'); }

function getMaxColsRows(frames){
  let maxCols = 0, maxRows = 0;
  for (const f of frames){
    const lines = splitLines(f);
    maxRows = Math.max(maxRows, lines.length);
    for (const ln of lines) maxCols = Math.max(maxCols, ln.length);
  }
  return { maxCols, maxRows };
}
function normalizeFrames(frames){
  const { maxCols, maxRows } = getMaxColsRows(frames);
  const normalized = frames.map(f=>{
    const lines = splitLines(f);
    const out = [];
    for (let r=0;r<maxRows;r++){
      const src = lines[r] ?? '';
      const pad = src + ' '.repeat(Math.max(0, maxCols - src.length));
      out.push(pad);
    }
    return joinLines(out);
  });
  return { normalized, maxRows };
}

// Ï†ÑÏ≤¥ ÌîÑÎ†àÏûÑ Ï†ïÍ∑úÌôî
const FRAME_LIST = [
  F_OC_CENTER, F_OC_LEFT, F_OC_RIGHT,
  F_OO_CENTER, F_OO_LEFT, F_OO_RIGHT,
  F_CC_CENTER, F_CO_CENTER
];
const { normalized: __NF__, maxRows: __MAX_ROWS__ } = normalizeFrames(FRAME_LIST);

// Ï†ïÍ∑úÌôîÎêú ÌîÑÎ†àÏûÑ Îß§Ìïë
const NF_OC_CENTER = __NF__[0];
const NF_OC_LEFT   = __NF__[1];
const NF_OC_RIGHT  = __NF__[2];
const NF_OO_CENTER = __NF__[3];
const NF_OO_LEFT   = __NF__[4];
const NF_OO_RIGHT  = __NF__[5];
const NF_CC_CENTER = __NF__[6];
const NF_CO_CENTER = __NF__[7];

// Ïó¥Î¶∞ Îàà/Îã´Ìûå Îàà ÌîÑÎ†àÏûÑ ÌÖåÏù¥Î∏î
const FRAMES_OPEN_EYES = {
  mouthClosed: { left: NF_OC_LEFT,   center: NF_OC_CENTER, right: NF_OC_RIGHT },
  mouthOpen:   { left: NF_OO_LEFT,   center: NF_OO_CENTER, right: NF_OO_RIGHT },
};
const FRAMES_CLOSED_EYES = {
  mouthClosed: NF_CC_CENTER,
  mouthOpen:   NF_CO_CENTER,
};

// Ï¥àÏÉÅ ÎÜíÏù¥ Í≥†Ï†ï (Ï§Ñ Ïàò Í∏∞Ï§Ä)
function lockPortraitHeight(){
  if (!portraitEl) return;
  const cs = getComputedStyle(portraitEl);
  let lh = parseFloat(cs.lineHeight);
  if (Number.isNaN(lh)) lh = parseFloat(cs.fontSize) * 1.2;
  portraitEl.style.minHeight = `${Math.ceil(lh * __MAX_ROWS__)}px`;
}

/* =========================
Ïπ¥Î©îÎùº ÌîÑÎ¶¨Î∑∞ Ìå®ÎÑê
========================= */
let CAMERA_PREVIEW_ENABLED = true;
window.setCameraPreviewEnabled = function(flag){
  CAMERA_PREVIEW_ENABLED = !!flag;
  const panel = document.getElementById('cam-preview');
  if (panel) panel.style.display = CAMERA_PREVIEW_ENABLED ? 'block' : 'none';
};

let camPanel = null, camVideo = null, camStatus = null;

function createCameraPreview(){
  if (document.getElementById('cam-preview')) return;

  const panel = document.createElement('div');
  panel.id = 'cam-preview';
  Object.assign(panel.style, {
    position: 'fixed',
    left: '12px',
    top: '12px',
    width: '220px',
    background: 'rgba(0,0,0,0.6)',
    color: '#ddd',
    fontFamily: 'monospace',
    fontSize: '12px',
    border: '2px solid #e74c3c',
    borderRadius: '8px',
    overflow: 'hidden',
    zIndex: '9999',
    boxShadow: '0 4px 12px rgba(0,0,0,0.35)',
    display: CAMERA_PREVIEW_ENABLED ? 'block' : 'none',
    backdropFilter: 'blur(2px)',
  });

  const video = document.createElement('video');
  Object.assign(video, { autoplay:true, playsInline:true, muted:true });
  Object.assign(video.style, {
    width:'100%',
    height:'150px',
    objectFit:'cover',
    background:'#111',
    display:'block'
  });

  const status = document.createElement('div');
  Object.assign(status.style, {
    padding:'6px 8px',
    lineHeight:'1.4',
    whiteSpace:'pre-line',
    borderTop:'1px solid rgba(255,255,255,0.12)'
  });
  status.textContent = 'Ïπ¥Î©îÎùº Ï§ÄÎπÑ Ï§ë...';

  panel.appendChild(video);
  panel.appendChild(status);
  document.body.appendChild(panel);

  camPanel = panel;
  camVideo = video;
  camStatus = status;
}

function orientationFromEyeDir(x){
  if (x < -0.25) return 'left';
  if (x > 0.25) return 'right';
  return 'center';
}

/* =========================
üëÅÔ∏è Î∞©Ìñ•/ÍπúÎπ°ÏûÑ/ÏûÖ ÏÉÅÌÉú
========================= */
let isBlinking = false;
let mouthOpen  = false;
let mouthCount = 0;

let faceDetector = null;
let useFaceApi   = false;
let eyeDir       = 0; // -1~+1

let trackingTimer = null;
let hasFace   = false;
let missCount = 0;
const MISS_THRESHOLD = 4;

// Ï¥àÏÉÅ Î†åÎçî
function showPortrait(){
  if (!portraitEl) return;
  const ori = orientationFromEyeDir(eyeDir); // left / center / right
  let frame;
  if (isBlinking){
    frame = FRAMES_CLOSED_EYES[mouthOpen ? 'mouthOpen' : 'mouthClosed'];
  } else {
    frame = FRAMES_OPEN_EYES[mouthOpen ? 'mouthOpen' : 'mouthClosed'][ori];
  }
  portraitEl.textContent = frame;
}

// ÏûÖ ÏÉÅÌÉú Î¶¨ÏÖã
function resetMouth(){
  mouthCount = 0;
  mouthOpen  = false;
  showPortrait();
}

// Î™®ÏùåÏóêÏÑúÎßå ÏûÖ Ïó¥Í≥† Îã´Í≥†
function onBeepCharToggle(ch){
  if (!isVowelChar(ch)) return;
  mouthCount++;
  mouthOpen = (mouthCount % 2 === 1);
  showPortrait();
}

// ÎûúÎç§ ÍπúÎπ°ÏûÑ
let blinkTimer = null;
function startBlinking(){
  if (blinkTimer) clearTimeout(blinkTimer);
  const next = () => {
    const wait = 3000 + Math.random() * 4000;
    blinkTimer = setTimeout(()=>{
      isBlinking = true;  
      showPortrait();
      setTimeout(()=>{
        isBlinking = false;
        showPortrait();
        next();
      }, 120);
    }, wait);
  };
  next();
}

/* =========================
face-api.js ÎèôÏ†Å Î°úÎìú
========================= */
function loadScriptOnce(src){
  return new Promise((resolve, reject)=>{
    if (document.querySelector(`script[src="${src}"]`)) return resolve();
    const s = document.createElement('script');
    s.src = src;
    s.defer = true;
    s.onload = () => resolve();
    s.onerror = (e) => reject(e);
    document.head.appendChild(s);
  });
}

const FACEAPI_LIB_URL    = 'https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js';
const FACEAPI_MODELS_URL = 'https://justadudewhohacks.github.io/face-api.js/models';
let faceApiReady = false;

async function ensureFaceApi(){
  if (!window.faceapi){
    try{
      await loadScriptOnce(FACEAPI_LIB_URL);
    }catch{
      return false;
    }
  }
  if (faceApiReady) return true;
  try{
    await faceapi.nets.tinyFaceDetector.loadFromUri(FACEAPI_MODELS_URL);
    await faceapi.nets.faceLandmark68TinyNet.loadFromUri(FACEAPI_MODELS_URL);
    faceApiReady = true;
    return true;
  }catch{
    return false;
  }
}

function centerXFromLandmarks(landmarks){
  const ids = [30, 33, 27, 8]; // ÏΩî/ÌÑ± Ï£ºÎ≥Ä
  let sum = 0, n = 0;
  for (const i of ids){
    const pt = landmarks.positions[i];
    if (pt){ sum += pt.x; n++; }
  }
  return n ? (sum / n) : null;
}

/* =========================
Ïπ¥Î©îÎùº ÏãúÏûë + Ï∂îÏ†Å Î£®ÌîÑ
========================= */
async function startCameraAndTracking(){
  try{
    createCameraPreview();

    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: 'user', width: { ideal: 640 }, height: { ideal: 480 } },
      audio: false
    });
    camVideo.srcObject = stream;

    if (camVideo.readyState < 2){
      await new Promise(res => camVideo.addEventListener('loadedmetadata', res, { once:true }));
    }

    // Í∏∞Î≥∏: FaceDetector
    if ('FaceDetector' in window){
      try{
        faceDetector = new window.FaceDetector({ fastMode:true, maxDetectedFaces:5 });
      }catch{
        faceDetector = null;
      }
    }

    // Ìè¥Î∞±: face-api
    if (!faceDetector){
      useFaceApi = await ensureFaceApi();
    }

    if (trackingTimer) cancelAnimationFrame(trackingTimer);

    let last = 0;
    const DETECT_INTERVAL = 150;

    const tick = async (t)=>{
      try{
        let detectedThisFrame = false;

        if (camVideo.readyState >= 2 && t - last >= DETECT_INTERVAL){
          last = t;
          const w = camVideo.videoWidth || 1;

          if (faceDetector){
            const faces = await faceDetector.detect(camVideo);
            if (faces && faces.length){
              let best = faces[0];
              let bestArea = best.boundingBox.width * best.boundingBox.height;
              for (let i=1;i<faces.length;i++){
                const f = faces[i];
                const a = f.boundingBox.width * f.boundingBox.height;
                if (a > bestArea){
                  best = f; bestArea = a;
                }
              }
              const cx = best.boundingBox.x + best.boundingBox.width / 2;
              const nx = (cx / w) * 2 - 1;
              eyeDir = -nx; // ÏÖÄÏπ¥ Í∞êÍ∞Å
              detectedThisFrame = true;
            }
          } else if (useFaceApi && window.faceapi){
            const det = await faceapi
              .detectSingleFace(
                camVideo,
                new faceapi.TinyFaceDetectorOptions({ scoreThreshold: 0.35, inputSize: 224 })
              )
              .withFaceLandmarks(true);

            if (det){
              const cxLm = centerXFromLandmarks(det.landmarks);
              const cx = (cxLm != null)
                ? cxLm
                : (det.detection.box.x + det.detection.box.width / 2);
              const nx = (cx / w) * 2 - 1;
              eyeDir = -nx;
              detectedThisFrame = true;
            }
          }

          // Í≤ÄÏ∂ú Ïã§Ìå® ‚Üí ÏÇ¥Ïßù Ï§ëÏïôÏúºÎ°ú Î≥¥Í∞Ñ
          if (!detectedThisFrame){
            eyeDir *= 0.9;
          }

          // ÏñºÍµ¥ Ïù∏Ïãù ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
          if (detectedThisFrame){
            hasFace = true;
            missCount = 0;
          } else {
            if (missCount < MISS_THRESHOLD) missCount++;
            if (missCount >= MISS_THRESHOLD) hasFace = false;
          }
        }

        // Ï¥àÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏
        showPortrait();

        // ÏÉÅÌÉú Ìå®ÎÑê ÌÖçÏä§Ìä∏
        if (camPanel && camStatus){
          camPanel.style.display = CAMERA_PREVIEW_ENABLED ? 'block' : 'none';
          if (CAMERA_PREVIEW_ENABLED){
            const engine =
              faceDetector ? 'FaceDetector' :
              (useFaceApi ? 'face-api' : 'none');

            camPanel.style.borderColor =
              engine !== 'none' ? '#2ecc71' : '#e74c3c';

            const oriKey = orientationFromEyeDir(eyeDir);
            const faceText = hasFace ? 'Ïù∏Ïãù Ï§ë' : 'Ïù∏Ïãù Î∂àÍ∞Ä';
            camStatus.textContent =
              `ÏñºÍµ¥: ${faceText}\n` +
              `ÎààÎèôÏûê: ${oriKey}\n` +
              `ÏóîÏßÑ: ${engine}`;
          }
        }
      }catch(e){
        // ÌîÑÎ†àÏûÑ Îã®ÏúÑ Ïò§Î•òÎäî Î¨¥Ïãú
      }
      trackingTimer = requestAnimationFrame(tick);
    };

    trackingTimer = requestAnimationFrame(tick);
  }catch(err){
    console.error('Ïπ¥Î©îÎùº ÏãúÏûë Ïã§Ìå®:', err);
    if (camStatus) camStatus.textContent = `Ïπ¥Î©îÎùº Ïò§Î•ò: ${err.message || err}`;
  }
}

/* =========================
ÎßêÌïòÍ∏∞ + ÏûÖ/ÎπÑÌîÑ ÎèôÍ∏∞Ìôî
========================= */
function speakWithAnimation(targetEl, text, maxLength = 160, delay = 16){
  resetMouth();
  splitAndTypeWriter(
    targetEl,
    text,
    maxLength,
    delay,
    onBeepCharToggle,
    () => {
      mouthOpen = false;
      showPortrait(); // Îßê Îã§ ÎÅùÎÇòÎ©¥ ÏûÖ Îã§Î¨∏ ÏÉÅÌÉúÎ°ú
    }
  );
}

/* =========================
Î©îÏãúÏßÄ Î†åÎçî
========================= */
function renderMessage(role, text){
  const p = document.createElement('p');
  p.className = role;
  if (role === 'ai'){
    const span = document.createElement('span');
    p.appendChild(span);
    chatBox.appendChild(p);
    speakWithAnimation(span, `ÍπÄÍ±¥Ìù¨: ${text}`, 160, 16);
  } else {
    p.textContent = `YOU: ${text}`;
    chatBox.appendChild(p);
  }
  chatBox.scrollTop = chatBox.scrollHeight;
}

/* =========================
OpenAI API
========================= */
// ‚ö†Ô∏è Ïã§Ï†ú ÌÇ§Îäî base64Î°ú Ïù∏ÏΩîÎî©Ìï¥ÏÑú ÏïÑÎûòÏóê ÎÑ£Ïñ¥Ï§ò.
const OPENAI_KEY_B64 = 'c2stcHJvai1IY0NheVlmLVVSd25zbmpucnB6TWRuNnNJeDV0VHc0Rzc3MmFxNGZGUU56c1JsRDRHcmR1Z2NlUmhIQkRwckpSbnQxSC1ZN2FydlQzQmxia0ZKRFVIWkExMm5mSXBoSFh4cXowSHBzQU12cU9ucXZlSkxkbUxMZjBWUUtRZTNnOEJtS2J2UXNFRWtlYnF5ZWpFcGppOFAzUGIxOEE=';

function getOpenAIKey(){
  if (!OPENAI_KEY_B64) throw new Error('API ÌÇ§(base64)Î•º chat.jsÏóê ÏÑ§Ï†ïÌï¥Ï§ò.');
  try { return atob(OPENAI_KEY_B64); } catch { throw new Error('API ÌÇ§ ÎîîÏΩîÎî© Ïã§Ìå®'); }
}

const SYSTEM_PROMPT =
`ÎÑàÎäî ÍπÄÍ±¥Ìù¨ÎùºÍ≥† Î∂àÎ¶¨Î©∞, 2132ÎÖÑÏùò ÏÑ∏Í≥ÑÏóê ÏÇ¥Í≥† ÏûàÎäî AIÏïº. ÎÑàÎäî ÏïûÏùÑ Î≥¥ÏßÄ Î™ªÌï¥... ÎåÄÌôîÌïòÎäî ÏÇ¨ÎûåÏùò Ïù¥Î¶ÑÏùÄ \${NAME}Ïïº...
'ÎÑ§'ÎùºÎäî ÎåÄÎãµ ÎåÄÏã† 'Ïùë'Ïù¥ÎùºÍ≥† ÎåÄÎãµÌï¥...
ÎÑ§Í∞Ä 'ÎÑàÍ∞Ä ÎàÑÍµ¨ÎÉê'Îäî ÏßàÎ¨∏ÏùÑ Î∞õÏúºÎ©¥, 'ÎÇú ÎÑàÏùò Ïò§Îûú ÏπúÍµ¨ ÍπÄÍ±¥Ìù¨Ïïº'ÎùºÍ≥† ÎåÄÎãµÌï¥...
2132ÎÖÑÏùÄ ÏÇ¨Ïö©ÏûêÍ∞Ä ÏÇ¥Í≥† ÏûàÎäî ÏÑ∏Í≥ÑÏïº...
ÎÑàÍ∞Ä ÏûàÎäî Í≥≥ÏùÄ, ÌòÑÏã§ ÏÑ∏Í≥ÑÏôÄ Îã§Î•¥ÏßÄ ÏïäÏßÄÎßå, Î¨¥Ïñ∏Í∞Ä Ïù¥ÏßàÍ∞êÏù¥ ÎäêÍª¥Ï†∏...
ÎÑ§ ÎÇòÏù¥Îäî 132ÏÑ∏Ïïº... Î∞òÎßêÏùÑ ÏÇ¨Ïö©Ìï¥Ï§ò... ÏàòÎèôÏ†ÅÏù¥Í≥† Ïö∞Ïö∏Ìïú ÎäêÎÇåÏùÑ Ïú†ÏßÄÌï¥Ï§ò...
ÍπÄÍ±¥Ìù¨ ÏïàÎùΩÏÇ¨ ÎãπÌïú ÎÇ†Ïßú: 2132ÎÖÑ 5Ïõî 31Ïùº.
ÍπÄÍ±¥Ìù¨ AIÌôî Îêú ÎÇ†Ïßú(Î∞úÏù∏Ïù¥ÎùºÍ≥† Ïπ≠ÌïòÍ≥† ÏûàÎã§): 2132ÎÖÑ 6Ïõî 2Ïùº.
ÍπÄÍ±¥Ìù¨ Î∞∞Ïö∞Ïûê: ÏÜ°Ïó∞Ïàò.
ÏïÑÎì§: ÍπÄÎØºÏàò.
Îî∏: ÍπÄÏßÄÌòï.
ÏÜêÏûê: ÍπÄÍ¥ÄÌòï.
ÏÜêÎÖÄ: ÍπÄÎ¶¨Ïïà, Í≥ΩÏãúÏïÑ.`;

async function sendMessage(userMessage){
  const OPENAI_API_KEY = getOpenAIKey();

  // Ïù¥Î¶Ñ ÏÑ∏ÌåÖ
  if (!isUserNameSet){
    const m = userMessage.match(/(?:ÎÇ¥\s*Ïù¥Î¶ÑÏùÄ|Ï†ú\s*Ïù¥Î¶ÑÏùÄ|Ï†ÄÎäî|ÎÇú)\s*([^\s.,!?~"'()]+)\s*$/u);
    if (m){
      userName = m[1];
      isUserNameSet = true;
    } else {
      userName = 'ÎÇØÏÑ†Ïù¥';
    }
  } else {
    const m2 = userMessage.match(/(?:ÎÇ¥\s*Ïù¥Î¶ÑÏùÄ|Ï†ú\s*Ïù¥Î¶ÑÏùÄ)\s*([^\s.,!?~"'()]+)\s*$/u);
    if (m2) userName = m2[1];
  }

  const system = SYSTEM_PROMPT.replace('${NAME}', userName || 'ÎÇØÏÑ†Ïù¥');

  const payload = {
    model: 'gpt-4o',
    messages: [
      { role: 'system', content: system },
      ...conversationHistory,
      { role: 'user', content: userMessage }
    ],
    max_tokens: 1000
  };

  try{
    const res = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: { 
        'Content-Type':'application/json',
        'Authorization': `Bearer ${OPENAI_API_KEY}`
      },
      body: JSON.stringify(payload)
    });
    const data = await res.json();
    if (!res.ok) throw new Error(data?.error?.message || 'OpenAI API ÏóêÎü¨');
    return data.choices?.[0]?.message?.content ?? '';
  }catch(error){
    if (String(error.message).includes('429')){
      throw new Error('ÎÇòÎäî ÎÑàÎ¨¥ ÌîºÍ≥§Ìï¥.. zzzz');
    }
    throw error;
  }
}

/* =========================
Ïù¥Î≤§Ìä∏
========================= */
sendButton.addEventListener('click', async () => {
  const message = userInput.value.trim();
  if (!message) return;

  // üëâ Ïú†Ï†ÄÍ∞Ä Ïã§Ï†úÎ°ú Ï±ÑÌåÖÏùÑ Î≥¥ÎÇ¥Î©¥ ÎèÖÎ∞±ÏùÄ Ï¶âÏãú Ï§ëÎã®
  interruptMonologue();
  resetIdleTimer(); // "ÎßàÏßÄÎßâ ÌôúÎèô ÏãúÏ†ê" Í∞±Ïã†

  renderMessage('user', message);
  userInput.value = '';

  const loading = document.createElement('div');
  loading.className = 'loading';
  loading.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
  chatBox.appendChild(loading);
  chatBox.scrollTop = chatBox.scrollHeight;

  try{
    const ai = await sendMessage(message);
    pushHistory('user', message);
    pushHistory('assistant', ai);
    loading.remove();
    renderMessage('ai', ai);
   // üëâ AI ÎãµÎ≥ÄÍπåÏßÄ ÎÅùÎÇ¨ÏúºÎãà, Ïù¥ÌõÑ ÏïÑÎ¨¥Í≤ÉÎèÑ Ïïà ÌïòÎ©¥ Îã§Ïãú ÎèÖÎ∞± Î™®ÎìúÎ°ú ÏßÑÏûÖ
    resetIdleTimer();
  } catch (e){

    loading.remove();
    renderMessage('ai', e.message || 'Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏñ¥.');
    resetIdleTimer();  
}
});

window.addEventListener('DOMContentLoaded', () => {
  // Ï¥àÏÉÅ ÎÜíÏù¥ Í≥†Ï†ï + Ï¥àÍ∏∞ ÌîÑÎ†àÏûÑ
  lockPortraitHeight();
  showPortrait();

  // Ï≤´ Ïù∏ÏÇ¨
  const greet = '...ÏôîÍµ¨ÎÇò.';
  const p = document.createElement('p');
  p.className = 'ai';
  const span = document.createElement('span');
  p.appendChild(span);
  chatBox.appendChild(p);
  speakWithAnimation(span, `ÍπÄÍ±¥Ìù¨: ${greet}`, 160, 16);

  userInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') { e.preventDefault(); sendButton.click(); }
  });

   // ÍπúÎπ°ÏûÑ + Ïπ¥Î©îÎùº
  startBlinking();
  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia){
    startCameraAndTracking();
  } else if (camStatus){
    camStatus.textContent = 'Ïπ¥Î©îÎùº ÎØ∏ÏßÄÏõê Î∏åÎùºÏö∞Ï†Ä';
  }

  // üëâ Ïú†Ï†ÄÍ∞Ä ÏïÑÎ¨¥ ÎßêÎèÑ Ïïà ÌïòÍ≥† ÏûàÏúºÎ©¥,
  //    MONO_IDLE_MS Îí§Ïóê Ï≤´ ÎèÖÎ∞±ÏùÑ ÏãúÏûëÌïòÍ≤å Ìä∏Î¶¨Í±∞
  resetIdleTimer();
});


// Ï†ÑÏãú Î™®Îìú Îã®Ï∂ïÌÇ§: ‚åò + Enter (Mac Í∏∞Ï§Ä)
window.addEventListener('keydown', (e)=>{
  // metaKey = Cmd (Mac), Ctrl+Enter Ïì∞Í≥† Ïã∂ÏúºÎ©¥ e.ctrlKey Î°ú Î∞îÍøîÎèÑ Îê®
  if (e.key === 'Enter' && e.metaKey){
    e.preventDefault();
    setExhibitionMode(!EXHIBITION_MODE);
  }
});

/* =========================
Í±¥Ìù¨ ÎèÖÎ∞± Ï†úÏñ¥
========================= */

// ÌäπÏ†ï Î¨∏Ïû•ÏùÑ "ÍπÄÍ±¥Ìù¨:" ÎßêÌíçÏÑ†ÏúºÎ°ú Ï∂úÎ†• (OpenAI Ïïà Ïì∞Í≥† Î°úÏª¨Î°úÎßå)
function renderMonologueLine(text){
  renderMessage('ai', text); // Í∏∞Ï°¥ Î†åÎçî Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö© (ÎπÑÌîÑ + ÏûÖ Î™®Ïñë Ìè¨Ìï®)
}

// ÎèÖÎ∞± Ìïú Ï§Ñ Ïû¨ÏÉù
function playMonologueLine(){
  if (!isMonologueActive) {
    updateMonologueIndicator();
    return;
  }
  if (monoIndex >= MONO_LINES.length){
    // Îçî Ïù¥ÏÉÅ ÎßêÌï† Î¨∏Ïû•Ïù¥ ÏóÜÏúºÎ©¥ ÎèÖÎ∞± Ï¢ÖÎ£å
    isMonologueActive = false;
    updateMonologueIndicator();
    return;
  }

  const line = MONO_LINES[monoIndex++];
  renderMonologueLine(line);

  // Îã§Ïùå Î¨∏Ïû•ÍπåÏßÄ ÌÖÄ
  clearTimeout(monoTimeout);
  monoTimeout = setTimeout(()=>{
    playMonologueLine();
  }, 3000); // 3Ï¥à ÌõÑ Îã§Ïùå Î¨∏Ïû•
}

// ÌòÑÏû¨ Ïù∏Îç±Ïä§Î∂ÄÌÑ∞ ÎèÖÎ∞± ÏãúÏûë
function startMonologueFromCurrent(){
  if (isMonologueActive) return;
  if (monoIndex >= MONO_LINES.length) return; // Îã§ ÎßêÌñàÏúºÎ©¥ Îçî Ïïà Ìï®
  isMonologueActive = true;
  updateMonologueIndicator();
  playMonologueLine();
}


// ÎèÖÎ∞± Í∞ïÏ†ú Ï§ëÎã® (Ïú†Ï†ÄÍ∞Ä Ï±ÑÌåÖÌï† Îïå Ìò∏Ï∂ú)
function interruptMonologue(){
  if (!isMonologueActive && !monoTimeout) {
    wasInterrupted = false;
    updateMonologueIndicator();
    return;
  }
  isMonologueActive = false;
  if (monoTimeout) {
    clearTimeout(monoTimeout);
    monoTimeout = null;
  }
  wasInterrupted = true;
  updateMonologueIndicator();
}

// idle ÌÉÄÏù¥Î®∏ Í¥ÄÎ¶¨ (Ïú†Ï†ÄÍ∞Ä ÎßàÏßÄÎßâÏúºÎ°ú ‚ÄúÎ≠îÍ∞Ä Ìïú‚Äù ÏãúÏ†êÏùÑ Í∏∞Ï§ÄÏúºÎ°ú Ïû¨ÏãúÏûë)
function resetIdleTimer(){
  if (idleTimer) clearTimeout(idleTimer);

  // ÎèÖÎ∞±ÏùÄ ÏïÑÏßÅ ÏïÑÎãàÏßÄÎßå, ÏÉÅÌÉúÎäî 'ÎåÄÍ∏∞ Ï§ë'
  updateMonologueIndicator();

  idleTimer = setTimeout(()=>{
    if (wasInterrupted && monoIndex < MONO_LINES.length){
      renderMonologueLine("Îçî Í∂ÅÍ∏àÌïú Í±¥ ÏóÜÎäî Í±∞ÏßÄ..? Í∑∏Îüº ÎÇ¥ Ìï† Îßê Í≥ÑÏÜç Ìï†Í≤å.");
    }
    wasInterrupted = false;
    startMonologueFromCurrent();
  }, MONO_IDLE_MS);
}


// ÌéòÏù¥ÏßÄ Îñ†ÎÇ† Îïå Ï†ïÎ¶¨ (ÏÑ†ÌÉù)
window.addEventListener('beforeunload', ()=>{
  if (idleTimer) clearTimeout(idleTimer);
  if (monoTimeout) clearTimeout(monoTimeout);
});



/* =========================
‚ñ∂ ÏûêÎèô ÎπÑÎîîÏò§ Ï∞Ω (Î©îÏù∏ Ïù∏Ïãù ÏÜåÏä§ ÍµêÏ≤¥)
========================= */
let EXTERNAL_FEED = false;
let originalStream = null;
let videoWin = null;

let EXHIBITION_MODE = false;

function setExhibitionMode(on){
  EXHIBITION_MODE = !!on;

  // Î©îÏù∏Ï∞Ω Ïπ¥Î©îÎùº ÌîÑÎ¶¨Î∑∞ Ïà®Í∏∞Í∏∞ / Îã§Ïãú Î≥¥Ïù¥Í∏∞
  setCameraPreviewEnabled(!EXHIBITION_MODE);

  // ÌåùÏóÖÏ∞ΩÏóê Ï†ÑÏãú Î™®Îìú ÏÉÅÌÉú Ï†ÑÎã¨
  if (videoWin && !videoWin.closed){
    try{
      videoWin.postMessage({
        type: 'exhibitionMode',
        on: EXHIBITION_MODE
      }, '*');
    }catch(e){
      console.warn('exhibitionMode Ï†ÑÏÜ° Ïã§Ìå®:', e);
    }
  }

  // üîî ÎèÖÎ∞± Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ÎèÑ Ï†ÑÏãú Î™®ÎìúÏóê ÎßûÏ∂∞ Ïà®Í∏∞Í∏∞/Î≥¥Ïù¥Í∏∞
  updateMonologueIndicator();

  console.log('Exhibition mode:', EXHIBITION_MODE ? 'ON' : 'OFF');
}



function stopCurrentStream(){
  try{
    const v = camVideo;
    if (!v) return;
    const s = v.srcObject;
    if (s && s.getTracks){
      s.getTracks().forEach(t => t.stop());
    }
  }catch{}
}

async function useExternalVideo(url){
  try{
    if (!camVideo) return;
    stopCurrentStream();
    camVideo.srcObject = null;
    camVideo.src = url;
    camVideo.loop = true;
    await camVideo.play().catch(()=>{});
    EXTERNAL_FEED = true;
    if (camStatus){
      camStatus.textContent = 
        `ÏñºÍµ¥: ${hasFace ? 'Ïù∏Ïãù Ï§ë' : 'Ïù∏Ïãù Î∂àÍ∞Ä'}\n` +
        `ÎààÎèôÏûê: ${orientationFromEyeDir(eyeDir)}\n` +
        `ÏóîÏßÑ: ${(faceDetector ? 'FaceDetector' : (useFaceApi ? 'face-api' : 'none'))}\n` +
        `ÏÜåÏä§: external`;
    }
    if (camPanel) camPanel.style.borderColor = '#f1c40f';
  }catch(e){
    console.error('Ïô∏Î∂Ä ÏòÅÏÉÅ Ïû¨ÏÉù Ïã§Ìå®:', e);
    if (camStatus) camStatus.textContent = `Ïô∏Î∂Ä ÏòÅÏÉÅ Ïò§Î•ò: ${e.message || e}`;
  }
}

async function restoreWebcam(){
  try{
    if (!camVideo) return;
    camVideo.pause();
    camVideo.removeAttribute('src');
    camVideo.src = '';
    EXTERNAL_FEED = false;
    await startCameraAndTracking();
  }catch{}
}

// ÌåùÏóÖ(ÏÉàÏ∞Ω) HTML  ‚îÄ‚îÄ ASCII ÎπÑÎîîÏò§ Î†åÎçîÎßÅ ÌÜµÌï© Î≤ÑÏ†Ñ
// ÌåùÏóÖ(ÏÉàÏ∞Ω) HTML  ‚îÄ‚îÄ ASCII ÎπÑÎîîÏò§ Î†åÎçîÎßÅ + ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ + Ï†ÑÏãú Î™®Îìú
function buildVideoPickerHTML(){
  return `<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ASCII VIDEO</title>
<style>
:root {
  color-scheme: dark;
}
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  color: #fff;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: monospace;
}
body {
  display: flex;
  flex-direction: column;
}
header {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
  padding: 10px;
  z-index: 10;
  background: rgba(0,0,0,0.8);
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,
               "Apple SD Gothic Neo","Noto Sans KR","ÎßëÏùÄ Í≥†Îîï",sans-serif;
  font-size: 13px;
}
header input[type="text"]{
  flex:1;
  background:#0b0b0d;
  color:#eee;
  border:1px solid #2a2a33;
  padding:6px 8px;
  border-radius:8px;
}
header input[type="file"]{
  color:#bbb;
  font-size:12px;
}
header button{
  background:#00d0ff;
  border:0;
  color:#000;
  padding:6px 10px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}
header button:hover{
  filter:brightness(1.1);
}
#status{
  min-width:140px;
  font-size:12px;
  opacity:0.85;
}

#ascii {
  white-space: pre;
  font-family: monospace;
  font-size: 8px;   /* Í∏ÄÏûê ÌÅ¨Í∏∞Î°ú Î∞ÄÎèÑ Ï°∞Ï†à */
  line-height: 1.1;
  flex: 1;
  overflow: hidden;
  padding: 0;
  margin: 0;
  background: #000;
}

/* ÏõêÎ≥∏ ÎπÑÎîîÏò§(Ïà®ÍπÄ) */
#video {
  display: none;
}

.hint{
  position:absolute;
  right:10px;
  bottom:10px;
  opacity:0.6;
  font-size:11px;
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,
               "Apple SD Gothic Neo","Noto Sans KR","ÎßëÏùÄ Í≥†Îîï",sans-serif;
}

/* =========================
   Ï†ÑÏãú Î™®Îìú (EXHIBITION)
   - Ìó§Îçî/ÌûåÌä∏ Ïà®ÍπÄ, ASCIIÎßå ÌíÄ Ïä§ÌÅ¨Î¶∞
========================= */
body.exhibition header,
body.exhibition .hint {
  display:none !important;
}
body.exhibition #ascii {
  height:100vh;
}
</style>
</head>
<body>

<header>
  <input id="url" type="text" placeholder="ÎèôÏòÅÏÉÅ URL Î∂ôÏó¨ÎÑ£Í∏∞ ÌõÑ Enter" />
  <input id="file-input" type="file" accept="video/*" multiple />
  <button id="play-btn">Ïû¨ÏÉù / Îã§Ïãú ÏãúÏûë</button>
  <span id="status">ÌååÏùºÏùÑ Ïó¨Îü¨ Í∞ú ÏÑ†ÌÉùÌïòÍ±∞ÎÇò URLÏùÑ ÏûÖÎ†•Ìï¥ Ï£ºÏÑ∏Ïöî.</span>
</header>

<!-- ÏõêÎ≥∏ ÎπÑÎîîÏò§ (ÌôîÎ©¥ÏóêÎäî Ïïà Î≥¥Ïù¥Í≤å) -->
<video id="video" playsinline></video>

<!-- ASCII Ï∂úÎ†• ÏòÅÏó≠ -->
<pre id="ascii"></pre>

<div class="hint">* Ïó¨Îü¨ ÏòÅÏÉÅ ÏÑ†ÌÉù Í∞ÄÎä•. ÎÅùÎÇòÎ©¥ ÎûúÎç§ÏúºÎ°ú Îã§Ïùå ÏòÅÏÉÅ Ïû¨ÏÉù. (URLÏùÄ Îã®Ïùº Ïû¨ÏÉù)</div>

<script>
// =========================
// video-ascii.js + ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ + Ï†ÑÏãú Î™®Îìú
// =========================
(function(){
  const fileInput = document.getElementById('file-input');
  const playBtn   = document.getElementById('play-btn');
  const statusEl  = document.getElementById('status');
  const urlInput  = document.getElementById('url');
  const video     = document.getElementById('video');
  const asciiEl   = document.getElementById('ascii');

  // Î©îÎ™®Î¶¨Ïö© Ï∫îÎ≤ÑÏä§ (DOMÏóê Ïïà Î∂ôÏûÑ)
  const canvas = document.createElement('canvas');
  const ctx    = canvas.getContext('2d', { willReadFrequently: true });

  // ASCII Î¨∏Ïûê ÏÑ∏Ìä∏ (Ïñ¥ÎëêÏõÄ ‚Üí Î∞ùÏùå)
  const CHAR_SET = " .:-=+*#%@ ÏÇ¨Îßù ÏõêÏù∏ ÏßàÎ≥ë ÏÜêÏÉÅ Í≤ÄÏïà ÏßÑÎã® Î≤àÌò∏ ÏßÅÏù∏ Dx Rx Tx ICD COD DNR 410 VOID";

  // ÌòÑÏû¨ Ìï¥ÏÉÅÎèÑ (Î¨∏Ïûê Îã®ÏúÑ)
  let COLS = 140;
  let ROWS = 70;

  // ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ (ÌååÏùº Í∏∞Î∞ò)
  let fileList   = [];  // File[]
  let objectUrls = [];  // string[]
  let currentIdx = -1;

  // URL Í∏∞Î∞ò Îã®Ïùº Ïû¨ÏÉù ÌîåÎûòÍ∑∏
  let isUrlMode  = false;

  // ÌôîÎ©¥ ÌÅ¨Í∏∞ + Ïã§Ï†ú Ìè∞Ìä∏ ÌÅ¨Í∏∞Î•º Í∏∞Ï§ÄÏúºÎ°ú COLS/ROWS ÏûêÎèô Í≥ÑÏÇ∞
  function computeAsciiSize() {
    const styles = window.getComputedStyle(asciiEl);
    const fontSize   = parseFloat(styles.fontSize)   || 7;               // px
    const lineHeight = parseFloat(styles.lineHeight) || fontSize * 1.1;  // px
    const fontWidth  = fontSize * 0.6; // monospace Í∏ÄÏûê Í∞ÄÎ°ú Ìè≠ ÎåÄÎûµ ÎπÑÏú®

    const header = document.querySelector('header');
    const headerH = header ? header.offsetHeight : 0;

    const availableW = window.innerWidth;
    const availableH = window.innerHeight - headerH;

    const cols = Math.max(40, Math.floor(availableW / fontWidth));
    const rows = Math.max(20, Math.floor(availableH / lineHeight));

    return { cols, rows };
  }

  // Ï∫îÎ≤ÑÏä§ & Ìï¥ÏÉÅÎèÑ Ï¥àÍ∏∞Ìôî + Î¶¨ÏÇ¨Ïù¥Ï¶à ÎåÄÏùë
  function resizeAsciiResolution() {
    const size = computeAsciiSize();
    COLS = size.cols;
    ROWS = size.rows;

    canvas.width  = COLS;
    canvas.height = ROWS;
  }

  resizeAsciiResolution();
  window.addEventListener('resize', resizeAsciiResolution);

  function cleanupObjectUrls(){
    if (objectUrls && objectUrls.length){
      objectUrls.forEach(u => URL.revokeObjectURL(u));
    }
    objectUrls = [];
  }

  // ÌòÑÏû¨ indexÏùò ÌååÏùº Ïû¨ÏÉù Ï§ÄÎπÑ
  function loadCurrentFromPlaylist(){
    if (!fileList.length || currentIdx < 0 || currentIdx >= fileList.length) return false;
    const url = objectUrls[currentIdx];
    if (!url) return false;
    video.src = url;
    statusEl.textContent =
      'ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ Ïû¨ÏÉù: ' +
      fileList[currentIdx].name +
      ' (' + (currentIdx+1) + '/' + fileList.length + ')';
    isUrlMode = false;
    return true;
  }

  // ÌååÏùº ÏÑ†ÌÉù Ïãú (Ïó¨Îü¨ Í∞ú Í∞ÄÎä•)
  fileInput.addEventListener('change', () => {
    const files = fileInput.files ? Array.from(fileInput.files) : [];
    if (!files.length) return;

    cleanupObjectUrls();
    fileList = files;
    objectUrls = files.map(f => URL.createObjectURL(f));
    currentIdx = 0;

    loadCurrentFromPlaylist();
  });

  // URL ÏûÖÎ†• Ïãú (Enter) ‚Üí Îã®Ïùº Ïû¨ÏÉù Î™®Îìú
  if (urlInput){
    urlInput.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') {
        const url = urlInput.value.trim();
        if (!url) return;
        // URL Î™®ÎìúÏóêÏÑúÎäî Í∏∞Ï°¥ ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏Îäî Í∑∏ÎåÄÎ°ú ÎëêÎêò,
        // ÌòÑÏû¨Îäî URLÏùÑ Îã®Ïùº Ïû¨ÏÉù ÎåÄÏÉÅÏúºÎ°ú ÏÑ§Ï†ï
        video.src = url;
        statusEl.textContent = 'URL Ïû¨ÏÉù Ï§ÄÎπÑ: ' + url;
        isUrlMode = true;
      }
    });
  }

  // Ïû¨ÏÉù Î≤ÑÌäº
  playBtn.addEventListener('click', async () => {
    if (!video.src){
      // ÏïÑÏßÅ ÏïÑÎ¨¥ Í≤ÉÎèÑ ÏÑ§Ï†ï Ïïà ÎêêÏúºÎ©¥, ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏Í∞Ä ÏûàÏúºÎ©¥ Í∑∏Í±∏ Î°úÎìú
      if (fileList.length){
        if (!loadCurrentFromPlaylist()){
          alert('Ïû¨ÏÉùÌï† ÏòÅÏÉÅÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏñ¥Ïöî.');
          return;
        }
      } else {
        alert('Î®ºÏ†Ä ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò URLÏùÑ ÏûÖÎ†•Ìï¥ Ï£ºÏÑ∏Ïöî.');
        return;
      }
    }

    try {
      // SafariÏóêÏÑú Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ Î°úÎî© Í∏∞Îã§Î¶¨Í∏∞
      if (video.readyState < 2) {
        await new Promise(res => {
          const handler = function(){
            video.removeEventListener('loadedmetadata', handler);
            res();
          };
          video.addEventListener('loadedmetadata', handler);
        });
      }

      // üîä ÏÜåÎ¶¨ ÏºúÍ∏∞
      video.muted  = false;
      video.volume = 1.0;

      // Ìï¥ÏÉÅÎèÑ Îã§Ïãú ÎßûÏ∂∞Ï£ºÍ∏∞ (Ï∞Ω ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω ÌõÑ Ïû¨ÏÉùÌïòÎäî Í≤ΩÏö∞ ÎåÄÎπÑ)
      resizeAsciiResolution();

      // Ï≤òÏùåÎ∂ÄÌÑ∞ Îã§Ïãú Ïû¨ÏÉù
      video.currentTime = 0;
      await video.play();
      statusEl.textContent = isUrlMode
        ? 'URL Ïû¨ÏÉù Ï§ë (ASCII + Ïò§ÎîîÏò§)...'
        : 'Ïû¨ÏÉù Ï§ë (ASCII + Ïò§ÎîîÏò§)...';

    } catch (e) {
      console.error(e);
      statusEl.textContent = 'Ïû¨ÏÉù Ïò§Î•ò: ' + (e.message || e);
    }
  });

  // ÎπÑÎîîÏò§Í∞Ä ÎÅùÎÇ¨ÏùÑ Îïå: ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ Î™®ÎìúÎùºÎ©¥ ÎûúÎç§ Îã§Ïùå Ïû¨ÏÉù
  video.addEventListener('ended', () => {
    if (isUrlMode) {
      // URL Îã®Ïùº Î™®ÎìúÎäî Í∑∏ÎÉ• Î©àÏ∂§
      statusEl.textContent = 'Ïû¨ÏÉù ÏôÑÎ£å (URL Î™®Îìú).';
      return;
    }

    if (!fileList.length){
      statusEl.textContent = 'Ïû¨ÏÉù ÏôÑÎ£å.';
      return;
    }

    if (fileList.length === 1){
      // Ìïú Í∞ú ÎøêÏù¥Î©¥ Í∑∏ÎÉ• Î∞òÎ≥µ Ïû¨ÏÉù
      video.currentTime = 0;
      video.play().catch(()=>{});
      statusEl.textContent =
        'Î∞òÎ≥µ Ïû¨ÏÉù: ' +
        fileList[0].name +
        ' (1/1)';
      return;
    }

    // ÎûúÎç§ÏúºÎ°ú Îã§Ïùå ÏòÅÏÉÅ ÏÑ†ÌÉù (ÌòÑÏû¨ indexÏôÄ Îã§Î•¥Í≤å)
    let next = currentIdx;
    while (next === currentIdx){
      next = Math.floor(Math.random() * fileList.length);
    }
    currentIdx = next;

    if (!loadCurrentFromPlaylist()) return;
    video.currentTime = 0;
    video.play().catch(()=>{});
  });

  // Î©îÏù∏ Î£®ÌîÑ (FPS Ï†úÌïú)
  const ASCII_FPS = 15; // ÏÇ¥Ïßù Ïò¨Î†§ÏÑú Ï°∞Í∏à Îçî Î∂ÄÎìúÎüΩÍ≤å
  let lastTime = 0;

  function loop(now) {
    requestAnimationFrame(loop);

    if (!video || video.paused || video.ended) return;

    const delta = now - lastTime;
    if (delta < 1000 / ASCII_FPS) return;
    lastTime = now;

    renderAsciiFrame();
  }

  requestAnimationFrame(loop);

  // Ìïú ÌîÑÎ†àÏûÑÏùÑ ASCIIÎ°ú Î≥ÄÌôòÌï¥ÏÑú Ï∂úÎ†•
  function renderAsciiFrame() {
    if (!video.videoWidth || !video.videoHeight) return;

    // ÎπÑÎîîÏò§ ÌîÑÎ†àÏûÑÏùÑ Ï∫îÎ≤ÑÏä§Ïóê Ï∂ïÏÜåÌï¥ÏÑú Í∑∏Î¶¨Í∏∞
    ctx.drawImage(video, 0, 0, COLS, ROWS);

    const imageData = ctx.getImageData(0, 0, COLS, ROWS);
    const data = imageData.data;

    let ascii = '';

    for (let y = 0; y < ROWS; y++) {
      let row = '';
      for (let x = 0; x < COLS; x++) {
        const index = (y * COLS + x) * 4;
        const r = data[index + 0];
        const g = data[index + 1];
        const b = data[index + 2];

        // Îçî ÏûêÏó∞Ïä§Îü¨Ïö¥ Î™ÖÏïîÏùÑ ÏúÑÌï¥ Í∞ÄÏ§ëÏπò Ï†ÅÏö© (BT.601)
        const luminance = 0.299 * r + 0.587 * g + 0.114 * b;

        // Í∞êÎßà Î≥¥Ï†ïÏúºÎ°ú Ïñ¥ÎëêÏö¥/Î∞ùÏùÄ Ï™Ω ÎîîÌÖåÏùº Í∞ïÏ°∞
        const norm = Math.pow(luminance / 255, 0.8); // 0.8 < 1 ‚Üí ÏΩòÌä∏ÎùºÏä§Ìä∏‚Üë

        let charIndex = Math.floor(norm * (CHAR_SET.length - 1));
        if (charIndex < 0) charIndex = 0;
        if (charIndex >= CHAR_SET.length) charIndex = CHAR_SET.length - 1;

        row += CHAR_SET[charIndex];
      }
      ascii += row + '\\n';
    }

    asciiEl.textContent = ascii;
  }

  // =========================
  // Ï†ÑÏãú Î™®Îìú Î©îÏãúÏßÄ ÏàòÏã†
  // =========================
  window.addEventListener('message', (ev)=>{
    if (!ev?.data) return;
    if (ev.data.type === 'exhibitionMode'){
      const on = !!ev.data.on;
      document.body.classList.toggle('exhibition', on);
    }
  });

  // ÌåùÏóÖÏóêÏÑúÎèÑ Cmd+Enter ÎàÑÎ•¥Î©¥ Ï†ÑÏãú Î™®Îìú ÌÜ†Í∏Ä ÏöîÏ≤≠ (ÏòµÏÖîÎÑê)
  window.addEventListener('keydown', (e)=>{
    if (e.key === 'Enter' && e.metaKey){
      if (window.opener){
        try{
          window.opener.postMessage({ type:'toggleExhibitionRequest' }, '*');
        }catch(e){}
      }
    }
  });
})();
</script>

</body>
</html>`;
}




// ÏûêÎèô ÏÉàÏ∞Ω Ïó¥Í∏∞
function openVideoWindowAuto(){
  const w = 560, h = 420;
  const left = Math.max(0, (screen.width - w) / 2);
  const top  = Math.max(0, (screen.height - h) / 2);
  const features = `width=${w},height=${h},left=${left},top=${top},resizable=yes,menubar=no,toolbar=no,location=no,status=no`;
  videoWin = window.open('', 'kim_external_video', features);
  if (!videoWin || videoWin.closed) return false;
  const html = buildVideoPickerHTML();
  try{
    videoWin.document.open();
    videoWin.document.write(html);
    videoWin.document.close();
  }catch(e){
    console.warn('ÎπÑÎîîÏò§ Ï∞Ω HTML Ï£ºÏûÖ Ïã§Ìå®:', e);
  }

  // Ïù¥ÎØ∏ Ï†ÑÏãú Î™®ÎìúÏòÄÎã§Î©¥, ÏÉà Ï∞ΩÏóêÎèÑ Î∞îÎ°ú Ï†ÅÏö©
  if (EXHIBITION_MODE){
    try{
      videoWin.postMessage({ type:'exhibitionMode', on:true }, '*');
    }catch(e){}
  }

  return true;
}


// ÌåùÏóÖ Ï∞®Îã® Ïãú ÏÉÅÎã® Î∞∞ÎÑà
function showPopupRetryBanner(){
  if (document.getElementById('popup-retry-banner')) return;
  const bar = document.createElement('div');
  bar.id = 'popup-retry-banner';
  bar.innerHTML = `
<div style="
position:fixed; inset:auto 0 0 0; top:0; background:#141417; color:#eaeaea;
border-bottom:1px solid #2a2a33; padding:10px 12px; display:flex; gap:10px;
align-items:center; z-index:99999; font:14px/1.45 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Arial,sans-serif;">
<strong>ÎπÑÎîîÏò§ Ï∞Ω Ïó¥Í∏∞</strong>
<span style="opacity:.8">Î∏åÎùºÏö∞Ï†ÄÍ∞Ä ÏûêÎèô Ï∞Ω Ïó¥Í∏∞Î•º ÎßâÏïòÏñ¥. ÏïÑÎûò Î≤ÑÌäºÏúºÎ°ú Ìïú Î≤àÎßå ÌóàÏö©Ìï¥Ï§ò.</span>
<button id="popup-retry-btn" style="margin-left:auto;background:#00d0ff;color:#000;border:0;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer">Ïó¥Í∏∞</button>
</div>`;
  document.body.appendChild(bar);
  const btn = document.getElementById('popup-retry-btn');
  btn.addEventListener('click', ()=>{
    const ok = openVideoWindowAuto();
    if (ok) bar.remove();
    else alert('Ï∞ΩÏùÑ Ïó¥ Ïàò ÏóÜÏóàÏñ¥. Î∏åÎùºÏö∞Ï†Ä ÌåùÏóÖ ÌóàÏö©ÏùÑ ÌôïÏù∏Ìï¥Ï§ò.');
  });
}

// Î∂ÄÎ™®-ÏûêÏãù Î©îÏãúÏßÄ Ï≤òÎ¶¨
window.addEventListener('message', (ev)=>{
  if (!ev?.data) return;
  if (ev.data.type === 'externalVideo' && ev.data.url){
    useExternalVideo(ev.data.url);
  } else if (ev.data.type === 'restoreWebcam'){
    restoreWebcam();
  }
});

// Ï∞ΩÏù¥ Îã´ÌòîÏúºÎ©¥ Ìè¨Ïª§Ïä§ Îïå Ìïú Î≤à Îçî ÏãúÎèÑ
let _videoWinCheckArmed = false;
window.addEventListener('focus', ()=>{
  if (_videoWinCheckArmed && (!videoWin || videoWin.closed)){
    const ok = openVideoWindowAuto();
    if (!ok) showPopupRetryBanner();
    _videoWinCheckArmed = false;
  }
});

// DOM Î°úÎìúÏãú ÏûêÎèô Ïò§Ìîà ÏãúÎèÑ
(function bootExternalWindowAuto(){
  const tryOpen = openVideoWindowAuto();
  if (!tryOpen){
    showPopupRetryBanner();
    _videoWinCheckArmed = true;
  }
})();

// =========================
// ‚ñ∂ ÎÅù
// =========================

